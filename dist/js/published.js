function _eC(e,t,i){window.error_catcher&&error_catcher.send_error(e,t,i||{});var n="";if(void 0!==i&&i.trace&&1==getCookie("show_me_debug")){var a="trace"+999999999*Math.random();n='<div style="margin-top:10px;"><a style="color: #0af;padding: 10px 0 0;" onclick="var el=document.getElementById(\''+a+"'); if(el){el.style.display=('none'==el.style.display)?'block':'none';}\">Подробнее &raquo;</a></div><div id=\""+a+'" style="margin-top:10px;display: none;"><ul>';for(var o=0;o<i.trace.length;o++)n+="<li>"+i.trace[o]+"</li>";n+="</ul></div>"}$('<div id="locked_screen" style="overflow:auto"><div class="wnd" style="text-align:left;margin:60px auto;"><div class="header">Ошибка'+(e.code>0?" #"+e.code:"")+'!</div><div style="font-size:16px;margin:30px 0 0;padding: 20px;background: rgba(0,0,0,.05);border-radius: 3px;">'+e.message+"</div>"+n+(t>0?'<div style="color:#ccc;margin-top:10px;font-size:10px;">(catcher '+t+")</div>":"")+'<div class="btn_wrap"><div class="btn-m btn-default btn-ghost" onclick="window.location.href=window.location.href;">Перезагрузить страницу</div></div></div></div>').appendTo($("body")),setTimeout(function(){throw e},0)}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function ge(e){return"string"==typeof e||"number"==typeof e?document.getElementById(e):e}function geByTag(e,t){return(t||document).getElementsByTagName(e)}function geByTag1(e,t){return t=t||document,t.querySelector&&t.querySelector(e)||geByTag(e,t)[0]}function geByClass(e,t,i){if(t=t||document,i=i||"*",!browser.msie8&&t.querySelectorAll&&"*"!=i)return t.querySelectorAll(i+"."+e);var n=[];if(t.getElementsByClassName){var a=t.getElementsByClassName(e);if("*"!=i){i=i.toUpperCase();for(var o=0,s=a.length;o<s;++o)a[o].tagName.toUpperCase()==i&&n.push(a[o]);o=s=null}else n=Array.prototype.slice.call(a);a=null}else{for(var r=geByTag(i,t),l=new RegExp("(^|\\s)"+e+"(\\s|$)"),o=0,s=r.length;o<s;++o)l.test(r[o].className)&&n.push(r[o]);r=l=o=s=0}return n}function geByClass1(e,t,i){return t=t||document,i=i||"*",!browser.msie8&&t.querySelector&&t.querySelector(i+"."+e)||geByClass(e,t,i)[0]}function ce(e,t,i){var n=document.createElement(e);return t&&extend(n,t),i&&setStyle(n,i),n}function re(e){return e=ge(e),e&&e.parentNode&&e.parentNode.removeChild(e),e}function se(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function rs(e,t){return each(t,function(t,i){e=e.replace(new RegExp("%"+t+"%","g"),i)}),e}function insertBefore(e,t){e.parentNode.insertBefore(t,e)}function insertAfter(e,t){e.parentNode.insertBefore(t,e.nextSibling)}function isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}function intval(e){return e===!0?1:parseInt(e)||0}function floatval(e){return e===!0?1:parseFloat(e)||0}function each(e,t){var i,n=0,a=e.length;if(void 0===a){for(i in e)if(t.call(e[i],i,e[i])===!1)break}else for(var o=e[0];n<a&&t.call(o,n,o)!==!1;o=e[++n]);return e}function extend(){var e,t=arguments,i=t[0]||{},n=1,a=t.length,o=!1;for("boolean"==typeof i&&(o=i,i=t[1]||{},n=2),"object"==typeof i||isFunction(i)||(i={});n<a;++n)if(null!=(e=t[n]))for(var s in e){var r=i[s],l=e[s];i!==l&&(o&&l&&"object"==typeof l&&!l.nodeType?i[s]=extend(o,r||(null!=l.length?[]:{}),l):void 0!==l&&(i[s]=l))}return i}function hasClass(e,t){return(e=ge(e))&&new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}function getStyle(e,t,i){if(e=ge(e),isArray(t)){var n={};return each(t,function(t,i){n[i]=getStyle(e,i)}),n}if(void 0===i&&(i=!0),!i&&"opacity"==t&&browser.msie){var a=e.style.filter;return a?a.indexOf("opacity=")>=0?parseFloat(a.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!i&&e.style&&(e.style[t]||"height"==t))return e.style[t];var o,s=document.defaultView||window;if(s.getComputedStyle){t=t.replace(/([A-Z])/g,"-$1").toLowerCase();var r=s.getComputedStyle(e,null);r&&(o=r.getPropertyValue(t))}else if(e.currentStyle){if("opacity"==t&&browser.msie){var a=e.currentStyle.filter;return a&&a.indexOf("opacity=")>=0?parseFloat(a.match(/opacity=([^)]*)/)[1])/100+"":"1"}var l=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});if(o=e.currentStyle[t]||e.currentStyle[l],"auto"==o&&(o=0),!/^\d+(px)?$/i.test(o)&&/^\d/.test(o)){var d=e.style,c=d.left,u=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,d.left=o||0,o=d.pixelLeft+"px",d.left=c,e.runtimeStyle.left=u}}if(i&&("width"==t||"height"==t)){var f=getSize(e,!0)[{width:0,height:1}[t]];o=(intval(o)?Math.max(floatval(o),f):f)+"px"}return o}function setStyle(e,t,i){if(e=ge(e)){if("object"==typeof t)return each(t,function(t,i){setStyle(e,t,i)});if("opacity"==t)browser.msie&&((i+"").length?e.style.filter=1!==i?"alpha(opacity="+100*i+")":"":e.style.cssText=e.style.cssText.replace(/filter\s*:[^;]*/gi,""),e.style.zoom=1),e.style.opacity=i;else try{var n="number"==typeof i;n&&/height|width/i.test(t)&&(i=Math.abs(i)),e.style[t]=n&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t)?i+"px":i}catch(e){debugLog([t,i])}}}function rnd(){return window.rnd_seed=(9301*window.rnd_seed+49297)%233280,window.rnd_seed/233280}function random(e){return Math.ceil(rnd()*e)}function irand(e,t){return Math.floor(rand(e,t))}function consoleDbg(e){window.dbgMode&&window.console&&console.log(e)}function isset(e){return void 0!==e}function extendClass(e,t){e.prototype=new t,e.prototype.constructor=e}function htmlentities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function htmlspecialchars(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function htmlspecialchars_decode(e,t){var i=0,n=0,a=!1;void 0===t&&(t=2),e=e.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var o={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===t&&(a=!0),"number"!=typeof t){for(t=[].concat(t),n=0;n<t.length;n++)0===o[t[n]]?a=!0:o[t[n]]&&(i|=o[t[n]]);t=i}return t&o.ENT_HTML_QUOTE_SINGLE&&(e=e.replace(/&#0*39;/g,"'")),a||(e=e.replace(/&quot;/g,'"')),e=e.replace(/&amp;/g,"&")}function setcookie(e,t,i,n,a,o){document.cookie=e+"="+escape(t)+(i?"; expires="+new Date(i):"")+(n?"; path="+n:"")+(a?"; domain="+a:"")+(o?"; secure":"")}function _initCookies(){window._cookies={};for(var e=document.cookie.split(";"),t=/^[\s]*([^\s]+?)$/i,i=0,n=e.length;i<n;i++){var a=e[i].split("=");2==a.length&&(window._cookies[a[0].match(t)[1]]=unescape(a[1].match(t)?a[1].match(t)[1]:""))}}function getCookie(e){return _initCookies(),window._cookies[e]}function setCookie(e,t,i,n){var a="";if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),a="; expires="+o.toGMTString()}document.cookie=e+"="+escape(t)+a+"; path=/"+(window.baseDomain?"; domain=."+window.baseDomain:"")+(n&&window.isHttps?"; secure":"")}function clone(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){for(var t=[],i=0,n=e.length;i<n;i++)t[i]=clone(e[i]);return t}if(e instanceof Object){var t={};for(var a in e)e.hasOwnProperty(a)&&e[a]!==document&&(t[a]=clone(e[a]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}function generateUUID(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)})}function fileUploaded(e){isset(e.type)&&FE.run("file_uploaded_"+e.type,e)}function fileUploadFail(e){isset(e.type)&&FE.run("file_upload_fail_"+e.type,e)}function makeBtnDisabled(e,t){return void 0===$(e).data("clicked")&&(t=t||"Загружается...",$(e).val(t).text(t).addClass("disabled").data("clicked",!0),!0)}function toggleDropdown(e){$(".dropdown_part:visible").hide();var t=$(e).closest(".inp_wrap"),i=t.children(".dropdown_part");i.css({width:t.width()}),i.removeClass("dropped_down dropped_up"),t.offset().top+t.outerHeight()+i.outerHeight()<$(window).height()?(i.css({top:t.outerHeight()-1}),i.addClass("dropped_down")):(i.css({top:-i.outerHeight()}),i.addClass("dropped_up")),i.show()}function initDropdown(){window.curDropDown=null;var e=$("html");e.click(function(){$(".dropdown_part:visible").hide()}),e.find(".dropdown_part").click(function(e){$(this).is(":visible")&&e.stopPropagation()}),e.find(".joined").click(function(e){$(this).closest(".sel_wrap").find(".dropdown_part").is(":visible")&&e.stopPropagation()})}function setStateCookie(e,t){"function"==typeof $.cookie&&($.removeCookie(e),$.cookie(e,t,{expires:360,path:"/"}))}function ColorLuminance(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var i,n,a="#";for(n=0;n<3;n++)i=parseInt(e.substr(2*n,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)).toString(16),a+=("00"+i).substr(i.length);return a}function rgb2hex(e){return e?(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):null):null}function hex2rgb(e){var t=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return[t>>16,(65280&t)>>8,255&t]}function escapeRus(e){var t=[];e+="";for(var i=1040;i<=1103;i++)t[i]=i-848;t[1025]=168,t[1105]=184;var n=[];for(i=0;i<e.length;i++){var a=e.charCodeAt(i);void 0!==t[a]&&(a=t[a]),a<=255&&(n[i]=escape(String.fromCharCode(a))),8470==a&&(n[i]="%B9"),43==a&&(n[i]="%2B")}return n.join("")}function getUrlVars(){var e=window.location.href.slice(window.location.href.indexOf("?")+1);if(""==e||window.baseUrl==e)return e=null,{};for(var t,i={},n=e.split("&"),a=0;a<n.length;a++)t=n[a].split("="),i[t[0]]=t[1];return t=n=e=null,i}function jAlert(e,t){t=$.extend({id:"jAlert",html:!0,showCloseBtn:!1,width:!1,okText:!1,btnCls:"ibtn-blue",btnWidth:100,onOk:function(){},headerText:!1,hideOnBlackoutClick:!1,alertClass:""},t);var i=$("#"+t.id);if(i.length){if(i.attr("class",i.attr("class").replace(/^custom-/g,"")),t.alertClass.length)for(var n=t.alertClass.split(/\s+/g),a=0,o=n.length;a<o;a++)i.addClass("custom-"+n[a]);!1!==t.headerText?i.find(".iblk_header").show().find(".h5-fake").text(t.headerText):i.find(".iblk_header").hide(),i.find(".wind-btn-apply").text(t.okText||"OK").attr("class","btn wind-btn-apply "+t.btnCls).css("width",t.btnWidth),i.find("#jAlertBody")[!0===t.html?"html":"text"](e),i.wind("setApplyFunc",function(){t.onOk()}),t.hideOnBlackoutClick&&i.on("click",function(){return!1}),!1!==t.width&&i.css({width:t.width}),i.wind("show")}i=null}function jConfirm(e,t,i){t=$.extend({width:500,html:!0,okText:"OK",cancelText:"Отмена",btnWidth:94,okClass:"ibtn-green",onOk:function(){},onCancel:function(){},headerText:!1,showClose:!0},t);var n;n=i===!0?$("#"+t.id):$("#jConfirm"),n.length&&(!1!==t.headerText?n.find(".iblk_header").show().find(".h5-fake").text(t.headerText):n.find(".iblk_header").hide(),!0===t.html?n.find("#jConfirmBody").html(e):n.find("#jConfirmBody").text(e),n.find("#jConfirmOk").attr("class","ibtn wind-btn-apply "+t.okClass).text(t.okText).css("min-width",t.btnWidth),n.find("#jConfirmCancel").text(t.cancelText).css("min-width",t.btnWidth),n.find(".wind-close")[t.showClose?"show":"hide"](),n.css({width:t.width}),n.wind("setApplyFunc",t.onOk),n.wind("setCancelFunc",t.onCancel),t.onClose&&"function"==typeof t.onClose?n.wind("setCloseFunc",t.onClose):n.wind("setCloseFunc",t.onCancel),n.wind("show")),n=null}function showDoneBox(e,t){var i=$('<div class="pp_mes_wrap"><div class="pp_mes">'+e+"</div></div>");t=$.extend({width:380,top:"40%",fadeIn:100,showTime:2e3,fadeOut:500,cls:"",el:i},t),i.css({width:t.width,"margin-left":-1*Math.round(t.width/2),top:t.top,opacity:0}),t.cls.length&&i.addClass(t.cls),i.appendTo($("body")),i.animate({opacity:1},t.fadeIn,function(){setTimeout(function(){t.el.animate({opacity:0},t.fadeOut,function(){$(this).remove()})},t.showTime)}),i=null}function goTo(e){window.location.href=window.baseUrl+e}function getUrl(){return window.location.href.replace(window.baseUrl,"")}function if_var_val(e,t,i){for(var n in t)if(e==n)return n=null,t[n];return n=null,i||!1}function plural(e,t,i,n){if(e<0&&(e*=-1),void 0===n)return 1==e?t:i;var a=e%10,o=e%100;return 1==e||1==a&&11!=o?(a=o=null,t):a>1&&a<5&&12!=o&&13!=o&&14!=o?(a=o=null,i):(a=o=null,n)}function strtr(e,t){for(var i in t)e=e.replace(new RegExp(i,"g"),t[i]);return i=null,e}function number_format(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,s=void 0===n?" ":n,r=void 0===i?".":i,l="";return l=(o?function(e,t){var i=Math.pow(10,t);return""+Math.round(e*i)/i}(a,o):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(r)}function formatFileSize(e,t){if(0==e)return"0 байт";void 0===t&&(t=0);var i=t+1||3,n=["байт","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(i))+" "+n[a]}function reachGoal(e){if(void 0!==window.Ya){var t=Ya.Metrika.counters();for(var i in t)window["yaCounter"+t[i].id].reachGoal(e),consoleDbg("reachGoal "+e);t=i=null}}function reachGoalByAttr(e,t){var i=e.attr(t);void 0!==i&&i.length&&reachGoal(i),i=null}function popoverForm(e){try{var t=$(e).closest(".blk"),i=$(e).closest(".blk_form_wrap"),n=$("#formPopover"),a=n.children(".wind-body");if(a.children("form").hide(),i.hasClass("is_popover")){var o=i.children("form.user_form");o.length?o.appendTo(n).addClass("is_popover"):o=n.children("form[id=frm"+t.attr("id")+"]"),o.length&&(reachGoalByAttr(o,"goal-popover"),n.children().hide(),o.show(),n.wind("show"))}t=i=n=a=null}catch(e){consoleDbg(e)}return!1}function initSlick(e){var t=e.find(".slider:first"),i=e.closest(".blk_box_slider");if(t.hasClass("slick-initialized"))return t.slick("unslick"),void t.slick(adapterManager.slickOpt[i.attr("id")]);var n=e.children(".settings-slick:first"),a={touchMove:!1,infinite:!0,speed:parseInt(n.attr("slide-aspeed"))||300,dots:1===parseInt(n.attr("slide-circle")),customPaging:function(){return"<p>&nbsp;</p>"},arrows:1===parseInt(n.attr("slide-arrow")),nextArrow:'<div class="next-slide"><div></div></div>',prevArrow:'<div class="prev-slide"><div></div></div>',slidesToShow:1};1===parseInt(n.attr("slide-auto"))&&1!=n.attr("in-af")&&(a.autoplay=!0,a.autoplaySpeed=1e3*parseFloat(n.attr("slide-pspeed"))||2e3),"crossfade"==n.attr("slide-anim")&&(a.fade=!0,a.cssEase="linear"),t.slick(a),window.animManager.onScroll(),window.adapterManager.slickOpt[i.attr("id")]=a}function showSectionPopup(e){var t=$("#popup_list > #"+e),i=(t.find(".section_popup_wnd"),$("#sections_list .blk_section.is_fixed")),n=$("body").width(),a=null;$("body").addClass("open_popup"),a=$("body").width()-n,$("body").css("margin-right",a),$("body>.navbar>.navbar-inner").css("padding-right",a),void 0!==window.module_geotarget&&window.module_geotarget.city.length&&t.find(".geotarget_module").text(window.module_geotarget.city).removeClass("hidden"),i.length&&(window.active_fixed_sections=i,$.each(i,function(){$(this).css({"z-index":5})})),t.addClass("open"),t.hasClass("initSlick")||(t.find(".blk_box_slider_self").each(function(){initSlick($(this))}),t.addClass("initSlick")),FE.run("show_section_popup",e)}function hideSectionPopup(e){var t=$("#popup_list > #"+e);t.removeClass("open"),reInitVideoIFrame(t),window.active_fixed_sections&&$.each(window.active_fixed_sections,function(){$(this).css({"z-index":999})}),$("body").css("margin-right",0).removeClass("open_popup"),$("body>.navbar>.navbar-inner").css("padding-right",0),FE.run("sectionPopup_hide")}function clickButtonLink(e,t,i){insertJavaScript(e,t,function(){var e=$(i);e.attr("href")&&("_blank"==e.attr("target")?window.open(e.attr("href")):window.location.href=e.attr("href"))})}function insertJavaScript(e,t,i){if(!e||!t)return void("function"==typeof i&&i());var n=document.getElementById(t);return n?void("function"==typeof i&&i()):(n=document.createElement("script"),n.type="text/javascript",n.src=e,n.id=t,"function"==typeof i&&(n.onload=i),void document.getElementsByTagName("body")[0].appendChild(n))}function btnPopupWnd(e){var t=$(e).closest(".blk"),i=t.attr("id"),n=$("#btnPopupWnd"),a=n.attr("cur-blk"),o=t.find(".wnd_data:first");if(void 0===a||a!=i){var s=parseInt(o.attr("wnd_width"))||600;"undefined"==typeof adapterManager||adapterManager.isPC()||(s=adapterManager.getSettings(adapterManager.type).window_popover_width),n.width(s),n.find(".wind-header h3, .wind-header .div_h3").text(o.find(".wnd_data_title").text()),n.find(".wind-body").html(o.find(".wnd_data_text").html()),n.attr("cur-blk",i),consoleDbg("btnPopupWnd: move content")}n.wind("show"),n=null}function showExpiredWind(e){$("#sessionExpired form#frmlogin").find("#frmlogin__magic").val(e),$("#sessionExpired").wind("show").find("#frmlogin__username").focus()}function ExpiredWindbeforeSend(){var e=$("#sessionExpired #frmlogin__password"),t=$("#sessionExpired #frmlogin__magic");e.val($.sha1($.sha1(e.val())+t.val())),e=t=null}function truncate(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function arrayRemoveByName(e,t){var i=e.indexOf(t),n=!1;return-1!=i&&(e=e.splice(i,1),n=!0),i=null,n}function arrayInsertBeforeItem(e,t,i){var n=e.indexOf(t),a=!1;return-1!=n&&(e.splice(n,0,i),a=!0),n=null,a}function arrayInsertAfterItem(e,t,i){var n=e.indexOf(t),a=!1;return-1!=n&&(n==e.length-1?e.push(i):e.splice(n+1,0,i),a=!0),n=null,a}function arrayInsertItemUniq(e,t){-1==e.indexOf(t)&&e.push(t)}function arrayMoveItemBefore(e,t,i){return!(!arrayRemoveByName(e,t)||!arrayInsertBeforeItem(e,i,t))}function arrayMoveItemAfter(e,t,i){return!(!arrayRemoveByName(e,t)||!arrayInsertAfterItem(e,i,t))}function arraySubset(e,t,i){var n=e.indexOf(t),a=e.indexOf(i),o=[];return-1!=n&&-1!=a&&(n>a&&(n+=a,a=n-a,n-=a),o=e.slice(n,a+1)),n=a=null,o}function guid(){return uuid.v4().replace(/-/g,"")}function ajaxLoad(ops){var o={type:"POST",ops:ops,cache:!1,timeout:4e4,url:window.baseUrl+ops.url,dataType:"json",data:ops.data?ops.data:null,beforeSend:function(e,t){this.ops.onBeforeSend&&"function"==typeof this.ops.onBeforeSend&&this.ops.onBeforeSend(this.ops)},success:function(data){if(!this.ops.onBeforeSuccess||"function"!=typeof this.ops.onBeforeSuccess||this.ops.onBeforeSuccess(data,this.ops)){if(isset(data.error)&&alert(data.error),data.html&&this.ops.block&&$(this.ops.block).html(data.html),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack),alert("Смотри ошибку в консоли"))}this.ops.onSuccess&&"function"==typeof this.ops.onSuccess&&this.ops.onSuccess(data,this.ops),window.dbgMode&&console.log(data)}},error:function(e,t,i){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(i))}}};return ops.withCredentials&&(o.xhrFields={withCredentials:!0},delete ops.withCredentials),$.ajax(o)}function scrollTop(){return document.body.scrollTop||document.documentElement.scrollTop}function cancelEvent(e){if(!(e=e||window.e))return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1}function initTabs(e,t){if(t=extend({itemTag:"a",tabsClass:"itab",activeClass:"active",tabsContainer:null},t),"string"==typeof e&&(e=$(e)),e.length&&!e.hasClass("itabs-inited")){var i=e.children(t.itemTag);i.length&&(i.click({ops:t},function(e){var i=$(this),n="."+t.tabsClass+"[id="+i.attr("itab-id")+"]",a=null;null===t.tabsContainer?a=$(n):("string"==typeof t.tabsContainer&&(t.tabsContainer=$(t.tabsContainer)),t.tabsContainer.length&&(a=t.tabsContainer.children(n))),a.length&&(a.parent().children("."+t.tabsClass+"."+t.activeClass).removeClass(t.activeClass),a.addClass(t.activeClass),i.parent().children(t.itemTag+"."+t.activeClass).removeClass(t.activeClass),i.addClass(t.activeClass)),e.preventDefault(),e.stopPropagation(),i=a=n=null}),e.addClass("itabs-inited")),i=null}}function helpSlider(e,t){var i="string"==typeof e?$(e):e;if(i.length){i.addClass("help-slider-inited"),i.find(".prev_slide, .next_slide").click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),$(this).hasClass("next_slide")?"next":"prev")});var n=i.find(".slides_container");n.css({overflow:"hidden",position:"relative"}),n.children().css({cursor:"pointer"}).click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),"next")})}i=null}function helpSliderRoll(e,t){var i=e.find(".slides_container"),n=i.children(),a=n.filter(":visible"),o=null,s=null,r=a.height();if(!a.is(":animated"))if(i.css({height:r}),a.css({position:"absolute",top:0,left:0}),"prev"===t){if(o=a.prev(),!o.length)return;s=o.width(),o.css({position:"absolute",opacity:1,left:-s}).show(),a.animate({left:s,opacity:.5},400,function(){$(this).hide()}),o.animate({left:0},400,function(){$(this).css({position:"static"})}),0==o.prev().length&&o.closest(".help-slider-inited").find(".prev_slide").hide(),o.closest(".help-slider-inited").find(".next_slide").show()}else if("next"===t){if(o=a.next(),!o.length)return;s=o.width(),o.css({position:"absolute",opacity:1,left:s}).show(),a.animate({left:-s,opacity:.5},400,function(){$(this).hide()}),o.animate({left:0},400,function(){$(this).css({position:"static"})}),0==o.next().length&&o.closest(".help-slider-inited").find(".next_slide").hide(),o.closest(".help-slider-inited").find(".prev_slide").show()}i=n=a=o=s=r=null}function initImgSlider(e){return e=extend({obj:null,editorMode:!0,showBalls:!1,delayBeforeChange:2e3,changeOnClick:!1,changeSpeed:1e3,changeType:"slide",pauseOnHover:!0},e),null===e.obj?0:"string"!=typeof e.obj||(e.obj=$(e.obj),e.obj.length)?(e._animating=!1,e.$slider=e.obj.find(".slider_images:first"),e.$ar_L=e.$slider.find(".arrow_left:first"),e.$ar_R=e.$slider.find(".arrow_right:first"),e.$balls=e.$slider.find(".balls:first"),e.$imgs=e.$slider.find(".imgs:first"),e.$resizer=e.$slider.find(".imgslider_resizer:first"),window.imgSlider?++window.imgSlider.cnt:window.imgSlider={cnt:1,collection:{}},window.imgSlider.collection[window.imgSlider.cnt]=e,e._cnt=window.imgSlider.cnt,e.$slider.attr("slider",window.imgSlider.cnt),e.showBalls&&e.$balls.show(),e.$ar_L.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"prev")}),e.$ar_R.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"next")}),e.pauseOnHover&&e.$slider.find(".arrow,.imgs:first").mouseover(function(){imgSliderKillTimer($(this).closest(".slider_images").addClass("over_slide").attr("slider"))}).mouseout(function(){imgSliderSetTimer($(this).closest(".slider_images").removeClass("over_slide").attr("slider"))}),e.editorMode?(e.delayBeforeChange=0,e.$resizer.show(),$(document).mousedown(function(e){$(e.target).hasClass("imgslider_resizer")&&(window.imgSliderResize=!0,window.imgSliderResizeTop=e.pageY,window.imgSliderResizeH=$())}),$(document).mousemove(function(e){window.imgSliderResize&&console.log("move ",e.pageY-window.imgSliderResizeTop)}),$(document).mouseup(function(e){window.imgSliderResize&&(window.imgSliderResize=!1,console.log("stop ",e.pageY-window.imgSliderResizeTop),window.imgSliderResizeTop=null)})):imgSliderSetTimer(e),"ok"):1}function imgSliderSetTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e.delayBeforeChange&&(e._timer&&clearTimeout(e._timer),e._timer=setTimeout("imgSliderChange("+e._cnt+",'next');",e.delayBeforeChange))}function imgSliderKillTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e._timer&&clearTimeout(e._timer),e._timer="off"}function imgSliderChange(e,t){console.log("run slider animation. id=",e,", direction=",t);var i=window.imgSlider.collection[e];if(!i._animating){switch(i.changeType){case"slide":i._animating=!0;var n=i.$imgs.children("a:visible"),a=null,o=i.$imgs.width();"next"==t?(a=n.next(),a.length||(a=i.$imgs.children("a:first")),a.css({left:o}).show(),n.animate({left:-o},i.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),a.animate({left:0},i.changeSpeed)):"prev"==t&&(a=n.prev(),a.length||(a=i.$imgs.children("a:last")),a.css({left:-o}).show(),n.animate({left:o},i.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),a.animate({left:0},i.changeSpeed)),n=a=o=null}i.$slider.hasClass("over_slide")||imgSliderSetTimer(i)}i=null}function enlargeImage(e){if(_eh.$body||(_eh.$body=$("body")),_eh.$wnd||(_eh.$wnd=$(window)),_eh.$container||(_eh.$container=$('<div id="image-enlarge-cont"></div>'),_eh.$container.appendTo(_eh.$body),_eh.$container.click(function(){_eh.$newImg&&_eh.$newImg.animate({top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h},_eh.speed,function(){_eh.$container.hide(),$("html").removeClass("wind_opened"),_eh.$body.css("margin-right",0),_eh.$newImg.remove(),_eh.$newImg=!1})})),_eh.$img=$(e),_eh.$img.length){var t=_eh.$img.offset();_eh.curSize={w:_eh.$img.width(),h:_eh.$img.height(),x:t.left,y:t.top-scrollTop()},t=null;var i=$(new Image);i.unbind("load").bind("load",function(){_eh.origSize={w:$(this).get(0).naturalWidth,h:$(this).get(0).naturalHeight},_eh.$newImg=$(this),_eh.wndSize={w:_eh.$wnd.width()-2*_eh.step,h:_eh.$wnd.height()-2*_eh.step},_eh.newSize={w:0,h:0,x:0,y:0},_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.origSize.h=_eh.wndSize.w*_eh.origSize.h/_eh.origSize.w,_eh.origSize.w=_eh.wndSize.w),_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.origSize.w,_eh.newSize.h=_eh.origSize.h,_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.origSize.w)/2)+_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.origSize.h)/2)+_eh.step):_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.wndSize.w,_eh.newSize.h=Math.floor(_eh.newSize.w*_eh.origSize.h/_eh.origSize.w),_eh.newSize.x=_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.newSize.h)/2)+_eh.step):_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.newSize.h=_eh.wndSize.h,_eh.newSize.w=Math.floor(_eh.newSize.h*_eh.origSize.w/_eh.origSize.h),_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.newSize.w)/2)+_eh.step,_eh.newSize.y=_eh.step),_eh.bodyWidth=_eh.$body.width(),_eh.$container.show(),$("html").addClass("wind_opened"),_eh.$body.css("margin-right",_eh.$body.width()-_eh.bodyWidth),scrollTop(),_eh.$newImg.appendTo(_eh.$container).css({position:"absolute",display:"block",top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h}).animate({left:_eh.newSize.x,top:_eh.newSize.y,width:_eh.newSize.w,height:_eh.newSize.h},_eh.speed)}),i.attr("src",void 0!==_eh.$img.attr("original-src")?_eh.$img.attr("original-src"):_eh.$img.attr("src"))}}function mxSetup(e){!function(e,t){if(!t.__SV){var i,n,a,o;window.mixpanel=t,t._i=[],t.init=function(e,i,n){var s=t;for(void 0!==n?s=t[n]=[]:n="mixpanel",s.people=s.people||[],s.toString=function(e){var t="mixpanel";return"mixpanel"!==n&&(t+="."+n),e||(t+=" (stub)"),t},s.people.toString=function(){return s.toString(1)+".people (stub)"},a="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "),o=0;o<a.length;o++)!function(e,t){var i=t.split(".");2==i.length&&(e=e[i[0]],t=i[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}(s,a[o]);t._i.push([e,i,n])},t.__SV=1.2,i=e.createElement("script"),i.type="text/javascript",i.async=!0,i.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",n=e.getElementsByTagName("script")[0],n.parentNode.insertBefore(i,n)}}(document,window.mixpanel||[]),mixpanel.init("14bbe5ece6a7ad1216c5ea30a5194a28"),window.console&&console.log("Mix Panel init"),void 0!==e&&(mixpanel.identify(e),window.console&&console.log("Mix Panel identify id="+e))}function mxt(e,t){return void 0===window._kmq?void console.log("Kissmetrics track: ",e,", params: ",t):void(void 0===t?_kmq.push(["record",e]):_kmq.push(["record",e,t]))}function mxGetSourceLink(){var e=window.location.href.replace(window.baseUrl,""),t=null;return t=""==e||"sites/list"==e?"раздел Сайты":"sites/create"==e?"раздел Создание сайта":"profile/balance"==e?"раздел Баланс":e.indexOf("pages/edit")>0?"раздел Редактор сайта":e,e=null,t}function showImportantMessages(e){0==$("#important-messages").length?$("body").append('<div id="important-messages"><table><tr><td><div id="imp-mes-wrap"><div id="imp-mes-list"></div><div class="mt2"><div id="imp-mes-btn" onclick="closeImportantMessages();">OK</div></div></div></td></tr></table></div>'):($("#important-messages .imp-mes").remove(),$("#important-messages").show());var t=$("#imp-mes-list");for(var i in e)t.append('<div class="imp-mes" id="mes-'+e[i].id_message+'"><div class="date">'+e[i].d_date+'</div><div class="mes">'+e[i].mes+"</div></div>");if(!$("html").hasClass("wind_opened")){var n=$("body").width(),a=null;$("html").addClass("wind_opened"),a=$("body").width()-n,$("body").css("margin-right",a)}i=t=null}function closeImportantMessages(){$("#important-messages").hide(),$("html").removeClass("wind_opened"),$("body").css("margin-right",0);var e=[];$("#important-messages .imp-mes").each(function(){e.push(parseInt($(this).attr("id").replace(/^mes-/,"")))}),ajaxLoad({url:"profile/ajax/frm:remove_messages",data:{ids:e}}),e=null}function getURLParam(e){return decodeURI((RegExp(e+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function getURLParam2(e){var t=RegExp(e+"=(.+?)(&|$)").exec(location.search);return null!==t&&void 0!==t[1]?t[1]:null}function insertPixel(e){$(document).ready(function(){$("body").append($('<img src="'+e.replace("{order_id}",getURLParam("order_id"))+'" width="1" height="1" style="position: absolute;left:-9999px;"/>'))})}function stVisit(){var e=getCookie("LPmagCode"),t={ref:document.referrer};void 0===e?t.new=1:t.id=e,$.ajax({url:window.baseUrl+"stat/visit",data:t,cache:!1,success:function(e){var t=JSON.parse(e);if(console.log(t),void 0!==t.res)switch(t.res){case"0":console.log(t.mes);break;case"1":if(void 0!==t.id)stVisitPropagate(t.id);else{var i=getCookie("_magCode");void 0!==i&&stVisitPropagate(i)}}}})}function stVisitPropagate(e){var t,i=["lpmotor.ru","lpmotor.org","bm360.ru","admin.lpmotor.ru"];for(var n in i)t=document.createElement("img"),t.className="mag_img",t.src=("https:"==document.location.protocol?"https:":"http:")+"/"+i[n]+"/stat/magcode.png?id="+e,t.onload=function(){this.parentNode.removeChild(this)},document.getElementsByTagName("body")[0].appendChild(t);t=n=i=null}function stLpcidPropagate(){var e=getCookie("_lpcid");if(void 0!==e){var t,i,n=document.getElementsByTagName("body")[0];for(t in window._lpcid_hosts)window._lpcid_hosts[t].replace(/^http(|s):\/\//,"")!=document.location.host&&(i=new Image,i.className="mag_img",i.onload=stVisImgRemove,i.src=window._lpcid_hosts[t]+"/stat/cid.gif?v="+e+"&t="+ +new Date,n.appendChild(i));t=i=n=null}}function stVisImgRemove(){this.parentNode&&this.parentNode.removeChild(this)}function stVisImgLoaded(){stLpcidPropagate(),this.parentNode&&this.parentNode.removeChild(this)}function stVis(e){void 0===e&&(e="landing");var t=new Image,i=getURLParam2("p");t.className="mag_img",t.onload=stVisImgLoaded,t.src=("https:"==document.location.protocol?"https:":"http:")+"//"+document.location.host+"/stat/vis.gif?type="+e+"&ref="+document.referrer+(null===i?"":"&p="+encodeURI(i))+"&t="+ +new Date,document.getElementsByTagName("body")[0].appendChild(t),
t=null}function animInit(){}function createFrame(e,t){var i=document.createElement("iframe");i.className="mag_frame",i.src=e+"/tracer/frame/cid:"+t+"?_="+1*new Date,document.body.appendChild(i)}function gaSpread(e){console.log("gaSpread...");var t=getCookie("_ga_cid");if(void 0!==t)switch(console.log("gaSpread=",e),createFrame("https://admin.lpmotor.ru",t),e){case"lpmotor":createFrame("http://bm360.ru",t);break;case"bm360":createFrame("http://lpmotor.ru",t)}}function analyticSendEvent(e,t){if(!window.carrotquest)return!1;if(t=void 0===t?{}:t,void 0!==t.delay&&t.delay>0)return setTimeout(function(){analyticSendEvent(e,t)},t.delay),delete t.delay,!0;if(void 0!==t.check_cookie){var i=getCookie(t.check_cookie);if(void 0===i)return!1;if(void 0!==t.value_cookie&&t.value_cookie!=i)return!1}if(void 0!==t.once&&t.once===!0)try{var n=localStorage.getItem("analytic_event");if(n=null==n||void 0===n?{}:JSON.parse(n),void 0!==n[e])return!1;n[e]=1,localStorage.setItem("analytic_event",JSON.stringify(n))}catch(e){console.log(e)}carrotquest.track(e,t),dbgMode&&console.log("send event [",e,"] ",t)}function funnelEvent(e,t){$.ajax({url:window.baseUrl+"funnel/event",method:"post",dataType:"json",data:{funnel:e,step:t},success:function(i){void 0!==i.status&&console.log("funnel:",e,", step:",t,", status:",i.status),void 0!==i.exception&&alert("Funnel error\n"+(i.exception.code?"#"+i.exception.code+"\n":"")+i.exception.message)}})}function var_dump(){var e="",t=0,i=0,n=function(e){var t=/\W*function\s+([\w\$]+)\s*\(/.exec(e);return t?t[1]:"(Anonymous)"},a=function(e,t){for(var i="",n=0;n<e;n++)i+=t;return i},o=function(e,t){var i="";if(null===e)i="NULL";else if("boolean"==typeof e)i="bool("+e+")";else if("string"==typeof e)i="string("+e.length+') "'+e+'"';else if("number"==typeof e)i=parseFloat(e)==parseInt(e,10)?"int("+e+")":"float("+e+")";else if(void 0===e)i="undefined";else if("function"==typeof e)i+="function "+n(e);else if(e instanceof Date)i="Date("+e+")";else if(e instanceof RegExp)i="RegExp("+e+")";else if(e.nodeName)switch(e.nodeType){case 1:i=void 0===e.namespaceURI||"http://www.w3.org/1999/xhtml"===e.namespaceURI?'HTMLElement("'+e.nodeName+'")':'XML Element("'+e.nodeName+'")';break;case 2:i="ATTRIBUTE_NODE("+e.nodeName+")";break;case 3:i="TEXT_NODE("+e.nodeValue+")";break;case 4:i="CDATA_SECTION_NODE("+e.nodeValue+")";break;case 5:i="ENTITY_REFERENCE_NODE";break;case 6:i="ENTITY_NODE";break;case 7:i="PROCESSING_INSTRUCTION_NODE("+e.nodeName+":"+e.nodeValue+")";break;case 8:i="COMMENT_NODE("+e.nodeValue+")";break;case 9:i="DOCUMENT_NODE";break;case 10:i="DOCUMENT_TYPE_NODE";break;case 11:i="DOCUMENT_FRAGMENT_NODE";break;case 12:i="NOTATION_NODE"}return i},s=function(e,i,r,l){var d="";i>0&&i++;var c=a(r*(i-1),l),u=a(r*(i+1),l),f="",p="";if("object"==typeof e&&null!==e)if(e.jquery)f+=(e.selector?"jQuery('"+e.selector+"')":"[jQuery object]")+"\n";else{if(e.constructor&&"PHPJS_Resource"===n(e.constructor))return e.var_dump();t=0;for(d in e)t++;f+="array("+t+") {\n";for(var h in e){var m=e[h];"object"!=typeof m||null===m||m instanceof Date||m instanceof RegExp||m.nodeName?(p=o(m),f+=u+"["+h+"] => "+p+"\n"):f+=u+"["+h+"] => "+s(m,i+1,r,l)}f+=c+"}\n"}else f=o(e);return f};for(e=s(arguments[0],0,2," "),i=1;i<arguments.length;i++)e+="\n"+s(arguments[i],0,2," ");return e}function lockScreen(e,t){t=extend({show_animation:!1,show_timer:!1,show_btn_close:!1,delay_before:0,css_class:""},t);var i={},n=$('<div class="locker" style="display: none"><div class="locker-background"></div><div class="locker-content"><div class="locker-btn-list"><div class="locker-close-btn"></div></div><div class="locker-animation"></div><div class="locker-text"></div><div class="locker-timer"></div></div></div>');t.css_class.length>0&&n.addClass(t.css_class);var a=generateUUID();if(n.attr("id",a),n.find(".locker-close-btn:first").bind("click",function(){unlockScreen(a)}),void 0!==e&&e.length>0&&(i["l-show-text"]=!0,n.find(".locker-content .locker-text:first").html(e)),t.show_animation===!0&&(i["l-show-animation"]=!0),t.show_timer===!0&&(i["l-show-timer"]=!0),t.show_btn_close===!0&&(i["l-show-btn-close"]=!0),Object.keys(i).length>0&&(i["l-show-content"]=!0,n.addClass(Object.keys(i).join(" "))),$("body").append(n),t.delay_before>0){var o=setTimeout(function(){n.show()},t.delay_before);n.attr("timeout_id",o)}else n.show();return n.attr("id")}function unlockScreen(e){var t=$("");t=void 0!==e?$("#"+e):$("body").children(".locker:last"),void 0!==t.attr("timeout_id")&&clearTimeout(t.attr("timeout_id")),t.remove()}function processingBlockInCells(e){"undefined"!=typeof adapterManager&&adapterManager.updateCells(e.closest(".blk_container")),(!0===window._isEditor||"undefined"!=typeof adapterManager&&adapterManager.isEditor())&&e.find(".blk_image_ext").each(function(){pages_editor.setZoomImgExt($(this).attr("id"),$(this).find("img:first"))}),e.find(".blk_image").each(function(){var e=$(this).find("img:first"),t=$(this).parent().width(),i={w:e.width(),h:e.height()};t<=e.attr("prod_w")?(t=t<2?2:t,t=t>e.attr("real_w")?e.attr("real_w"):t,e.css({width:t,height:"auto"}),e.height()<2&&(t=Math.ceil(2*i.w/i.h),e.css({width:t}))):e.css({width:e.attr("prod_w"),height:"auto"}),e=null}),e.find(".blk_video").each(function(){var e=$(this).find("iframe:first"),t=$(this).parent().width();t<=parseInt(e.css("width"))?(t=t<20?20:t,t=t>e.attr("data-width")?e.attr("data-width"):t,e.css({width:t})):e.css({width:e.attr("data-width")}),e=null})}function sliderEditorExtend(e){e.prototype.reinitFotorama=function(e){var t=e.closest(".blk_slider_data_wrap");0==t.length&&(t=e.closest(".blk-data"));var i,n=e.attr("data-minwidth"),a=e.attr("data-minheight"),o="100%"===n&&"100%"===a,s=e.attr("data-ratio"),r=e.attr("data-fit"),l=e.attr("data-loop"),d=e.attr("data-width"),c=e.attr("data-maxwidth"),u=e.attr("data-maxheight"),f=e.attr("data-transition"),p=e.attr("data-transitionduration"),h=e.attr("data-autoplay"),m=e.attr("data-arrows"),_=e.attr("data-nav"),w=[];for(o||(c=0,u=0),e.find("img").each(function(){var e=$(this);w.push({img_id:e.attr("id")||"",width:e.attr("width")||"",height:e.attr("height")||"",url:e.attr("src")||""}),e=null}),t.css("height",e.outerHeight()),e.remove(),t.find(".fotorama--hidden").remove(),e=$("<div></div>").addClass("fotorama"),e.attr("data-transition",f),e.attr("data-transitionduration",p),e.attr("data-autoplay",h),e.attr("data-arrows",m),e.attr("data-nav",_),e.attr("data-fit",r),l&&e.attr("data-loop",l),d&&e.attr("data-width",d),c&&e.attr("data-maxwidth",c),u&&e.attr("data-maxheight",u),n&&e.attr("data-minwidth",n),a&&e.attr("data-minheight",a),s&&e.attr("data-ratio",s),i=0;i<w.length;i++)this.createFotoramaImage(w[i],e);t.prepend(e),e.fotorama().on("fotorama:ready",function(){$(this).addClass("fotorama-is-ready");var e=$(this).closest(".blk_slider_data_wrap");return 0==e.length&&(e=$(this).closest(".blk-data")),e.css("height","auto"),!0}),t=w=null},e.prototype.createFotoramaImage=function(e,t){var i={};i.id=e.img_id,e.width&&(i.width=e.width),e.height&&(i.height=e.height);var n=$('<img style="display:none;" />').attr(i);n.load(function(){n=$(this),n.unbind("load"),n.show(),n=null}),n.attr("src",e.url),t.append(n),i=n=null}}function reInitYandexMap(e,t,i){if(ymaps.Map){window.ymaps_map_instances||(window.ymaps_map_instances={});var n=window.ymaps_map_instances,a=$("#map_"+e),o=a.hasClass("map-bg"),s=a.closest(".blk_section");n[e]&&(n[e].destroy(),delete n[e],o&&s.addClass("empty_map")),a.empty(),ymaps&&i&&t&&(n[e]=new ymaps.Map("map_"+e,{center:[t,i],zoom:17,controls:["zoomControl"]}),n[e].geoObjects.add(new ymaps.Placemark([t,i])),o&&s.removeClass("empty_map"))}}function reInitVideoIFrame(e){(e.hasClass("blk_video")?e:e.find(".blk_video")).each(function(){var e=$(this).find(".video iframe:first");e.attr("src",e.attr("src"))})}function initFileFields(e,t){window._isEditor?$(document).on("click",".user_form .userfiles_btn",function(e){return e.preventDefault(),!1}):($(".user_form .userfiles_input").on("click",function(){$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]").click()}),$(".user_form .userfiles_clear").on("click",function(e){e.stopPropagation();var t=$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]");confirm("Удалить загруженный вами файл?")&&(t.val(null).trigger("change",e),t=null)}),$(".user_form .userfiles_btn input[type=file]").on("change",function(i){var n,a=$(this),o=a.closest(".field_wrap"),s=o.find(".userfiles_selected_text");if(a.val()){var r="Файл выбран";if(this.files&&this.files[0]){if(t>0&&this.files.length>t)return a.val(null),o=a=null,alert("Можно выбрать не более "+t+" файл"+plural(t,"а","ов","ов")),!1;for(r=[],n=0;this.files.length>n;n++){if(e>0&&this.files[n].size>e)return a.val(null),o=a=null,alert("Файл должен быть не более "+formatFileSize(e)),!1;r.push(htmlspecialchars(this.files[n].name))}r=r.join(", ")}s.text(r).attr("title",r),o.addClass("userfiles_selected")}else s.text("").attr("title",""),s.removeAttr("style"),o.removeClass("userfiles_selected");o.find(".ui_error").hide(),o=a=null}))}function initAnchors(){$(document).on("click","a[href*=#]",function(e){var t=$(this).attr("href"),i=t.match(/#(.*)$/i),n=!1,a=$("#sections_list .blk_section.is_fixed:first-child"),o=0;if(a.length&&(o=a.outerHeight()),null!==i&&i[1]){var s=$("#"+i[1]);if(s.length)$("html,body").stop().animate({scrollTop:s.offset().top-o},600),n=!0;else{var r=t.replace(new RegExp("^#","gi"),""),l=$("a[name="+r+"]");l.length&&($("html,body").stop().animate({scrollTop:l.offset().top-o},600),n=!0)}if(n)return e.preventDefault(),!1}})}function F_wind(e,t){this.ops=t,this.$el=$(e),this.params={},this.hidePrevWnd=!0,this.whiteBg=!1,this.isShown=!1,this.$btnClose=this.$el.find("a.wind-close"),this.$btnApply=this.$el.find(".wind-btn-apply:first"),this.$btnCancel=this.$el.find(".wind-btn-cancel:first"),this.$el.on("click","a.wind-close",this,function(e){e.preventDefault(),e.data.clickBtnClose()}),this.$btnApply.click(this,function(e){e.preventDefault(),e.data.clickBtnApply()}),this.$btnCancel.click(this,function(e){e.preventDefault(),e.data.clickBtnCancel()}),this.applyFunc=function(){return!0}}function showWind(e,t){var i=$.extend({},{width:500,title:"Заголовок",cont:""},"object"==typeof t&&t);i.w,i.title,i.cont}function shakeWnd(e){e=$(e);var t=e.css("position");e.css("position","relative"),e.animate({left:-10},50,function(){$(this).animate({left:10},100,function(){$(this).animate({left:0},50,function(){$(this).css("position",t),t=null})})})}function FanimManager(){this.is_ready=!1,this.data={},this.visible_elements={},this.animated_blocks={},this.height_window=0,this.ready=function(){this.is_ready=!0,FE.runAndClr("animManager/ready")},this.init=function(e){var t=!1;if(window.animManager.data=e,window.animManager.height_window=window.innerHeight,!$.isEmptyObject(window.animManager.data))for(var i in window.animManager.data)t=$("#"+window.animManager.data[i].block_id),t.length>0&&(window.animManager.animated_blocks[i]=t);var n=!1;$(window).on("resize",function(e){n===!1&&(n=setTimeout(function(){n=!1,window.animManager.h=window.innerHeight,window.animManager.onScroll(e)},500))}),$(document).on("scroll",function(e){window.animManager.onScroll(e)}),$("#popup_list .section_popup").on("scroll",function(e){window.animManager.onScroll(e)}),FE.add("show_section_popup",function(){window.animManager.onScroll()}),window.animManager.onScroll()},this.getAnimatedObject=function(e){var t=$("#"+e);if(0==t.length)return!1;switch(t.attr("blk_class")){case"blk_image":t=t.find("img:first");break;case"blk_form":t=t.find(".blk_form_wrap:first");break;case"blk_text":t=t.find(".blk-data:first");break;case"blk_video":t=t.find(".video_container:first");break;case"blk_slider":t=t.find(".fotorama:first");break;case"blk_button":t=t.find("a:first")}return t},this.setStyle=function(e,t,i){var n=e[0],a=window.getComputedStyle(n),o="";o=a.getPropertyValue("-webkit-animation-delay")?"-webkit-animation-delay":a.getPropertyValue("-moz-animation-delay")?"-moz-animation-delay":a.getPropertyValue("-o-animation-delay")?"-o-animation-delay":"animation-delay",n.style.setProperty(o,"0s"),o=a.getPropertyValue("-webkit-animation-duration")?"-webkit-animation-duration":a.getPropertyValue("-moz-animation-duration")?"-moz-animation-duration":a.getPropertyValue("-o-animation-duration")?"-o-animation-duration":"animation-duration",n.style.setProperty(o,i+"s")},this.setClass=function(e,t){e.hasClass(t)||e.addClass(t)},this.onScroll=function(e){var t=self.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop,i=window.animManager.height_window/100*5;window.animManager.visible_elements={};for(var n in window.animManager.animated_blocks){var a=window.animManager.animated_blocks[n],o=window.animManager.getAnimatedObject(window.animManager.data[n].block_id);a!==!1&&o!==!1&&(o.closest(".blk_box_slider_self").length>0?(window.animManager.setClass(o,window.animManager.data[n].animation_type),a.removeClass("is_animated_block")):o.offset().top<=t+window.animManager.height_window-i&&o.offset().top+o.outerHeight()>=t+i&&(window.animManager.visible_elements[n]=a,window.animManager.startAnimation(a,o,window.animManager.data[n]),window.animManager.animated_blocks[n]=!1))}},this.startAnimation=function(e,t,i){window.animManager.setStyle(t,i.delay,i.duration);var n=function(){window.animManager.setClass(t,i.animation_type),e.removeClass("is_animated_block")};parseFloat(i.delay)>0?setTimeout(n,1e3*parseFloat(i.delay)):n()}}if(window.rnd_seed=(new Date).getTime(),!window._ua)var _ua=navigator.userAgent.toLowerCase();var browser={version:(_ua.match(/.+(?:me|ox|on|rv|it|era|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(_ua),msie:/msie/i.test(_ua)&&!/opera/i.test(_ua),msie6:/msie 6/i.test(_ua)&&!/opera/i.test(_ua),msie7:/msie 7/i.test(_ua)&&!/opera/i.test(_ua),msie8:/msie 8/i.test(_ua)&&!/opera/i.test(_ua),msie9:/msie 9/i.test(_ua)&&!/opera/i.test(_ua),mozilla:/firefox/i.test(_ua),chrome:/chrome/i.test(_ua),safari:!/chrome/i.test(_ua)&&/webkit|safari|khtml/i.test(_ua),iphone:/iphone/i.test(_ua),ipod:/ipod/i.test(_ua),iphone4:/iphone.*OS 4/i.test(_ua),ipod4:/ipod.*OS 4/i.test(_ua),ipad:/ipad/i.test(_ua),android:/android/i.test(_ua),bada:/bada/i.test(_ua),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(_ua),msie_mobile:/iemobile/i.test(_ua),safari_mobile:/iphone|ipod|ipad/i.test(_ua),opera_mobile:/opera mini|opera mobi/i.test(_ua),opera_mini:/opera mini/i.test(_ua),mac:/mac/i.test(_ua)};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var i=0,n=this.length;i<n;++i)e.call(t,this[i],i,this)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function e(e){return e<10?"0"+e:e}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+e(this.getUTCMilliseconds())+"Z"}),FE.add("onready","initDropdown()"),window.jQuery&&(jQuery.fn.outerHTML=function(e){return e?this.before(e).remove():jQuery("<div></div>").append(this.eq(0).clone()).html()}),$("body").popover({trigger:"hover",selector:".has_popover",placement:"top",html:"true",delay:"100"}),$(document).on("click",".btn-smart",function(){if(!$(this).data("button")){var e=$(this).attr("data-loading");$(this).button({loadingText:e?e:"Загрузка..."})}$(this).button("loading")}),$(document).on("submit","form.frm_lead",function(e){var id=$(this).attr("id");id||(id=$(this).attr("frm-id"));var frm=$(this),inp_track=frm.find("input.inp_track");if(inp_track.length||(inp_track=$('<input type="hidden" class="inp_track" name="inp_track" value=""/>'),inp_track.appendTo(frm)),inp_track.val(escapeRus(getCookie("bm360track"))),!frm.find("input.inp_utm").length){$('<input type="hidden" class="inp_utm" name="has_utm" value="1"/>').appendTo(frm);var params=getUrlVars();for(var k in params)$('<input type="hidden" class="inp_utm" name="'+k+'" value="'+params[k]+'"/>').appendTo(frm);params=k=null}var ajax_cfg={frm:$(this),type:"POST",cache:!1,timeout:4e4,url:(null!==window.baseUrl.match(/lpmotor.ru\/admin\/$/)?window.baseUrl.replace(/^http(|s):/,window.location.protocol).replace(/\/$/,""):"")+$(this).attr("action")+"/frm:"+id,beforeSend:function(e,t){var i=t.frm.find("input.ui_btn, input.btn-submit");if(i.css({width:i.outerWidth()}),!i.data("button")){var n=i.attr("lang");i.button({loadingText:n&&"en"==n?"Loading...":"Загрузка...",defText:i.val()}),n=null}i.button("loading")},success:function(data){if(frm.find(".ui_has_error").removeClass("ui_has_error"),frm.find(".ui_error").hide().html(""),frm.find("input.ui_btn, input.btn-submit").button("def"),"function"==typeof data.split&&(data=JSON.parse(data)),isset(data.error)){var attr=null,attrErr=null,firstErr=!1,attrId=null;for(attrId in data.error)attr=frm.find("#"+frm.attr("id")+"__"+attrId),attrErr=frm.find(".ui_error[for="+frm.attr("id")+"__"+attrId+"]"),attr.length&&(attr.addClass("ui_has_error"),!1===firstErr&&(attr.focus(),firstErr=!0)),attrErr.length&&(attrErr.show(),attrErr.html("<div>"+data.error[attrId].join("</div><div>")+"</div>"));attr=attrId=attrErr=firstErr=null}if(isset(data.exception)&&window.dbgMode&&alert(data.exception),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack))}if(isset(data.post_data))try{$.ajax({url:data.post_data.url,data:data.post_data.params,method:"POST",async:!0})}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_POST_request_error_] "+e.stack))}if(isset(data.res))if(1==data.res){reachGoalByAttr(frm,"goal-submitted");var mes=!1,data_mes_url=parseInt(frm.attr("data-mes-url")),f_show_msg=function(e){if(mes=e.attr("suссess-message"),mes.length||(mes="Спасибо!\\nВаша заявка принята.\\nВ ближайшее время мы с вами свяжемся!"),isset(data.lead_preview)){mes+='<div class="lead_preview"><div class="c_text">--------[ ВНИМАНИЕ ]--------</div><div class="c_text">(В предпросмотре заявка не создается)</div><div class="l_text mt1">Данные, принятые с формы:</div><ul class="l_text mb0">';for(var t in data.lead_preview)mes+="<li><b>"+data.lead_preview[t].name+"</b>: "+(null===data.lead_preview[t].val?"":data.lead_preview[t].val)+"</li>";mes+="</ul></div>"}};switch(data_mes_url){case 1:f_show_msg(frm);break;case 2:var loc=frm.attr("data-goto-url");if(loc.length){/^http(|s):\/\//.test(loc)!==!0&&(loc="http://"+loc);var inp;return-1!==loc.indexOf("{name}")&&(inp=frm.find(".field.fname:first input.inp"),inp.length&&(loc=loc.replace("{name}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{email}")&&(inp=frm.find(".field.femail:first input.inp"),inp.length&&(loc=loc.replace("{email}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{phone}")&&(inp=frm.find(".field.fphone:first input.inp"),inp.length&&(loc=loc.replace("{phone}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{order_id}")&&data.id_lead&&(loc=loc.replace("{order_id}",data.id_lead)),void(window.location.href=loc)}loc=null;break;case 3:var frm_id=frm.attr("frm-id"),lead_id=data.id_lead,key=data.key;if($("#ymis_"+frm_id).length>0){var c_ops={id:"j_lead_confirm",html:!0,okText:"Яндекс.Деньги",cancelText:"Банковская карта",btnWidth:120,okClass:"n-btn n-btn-success btn-round",cancelClass:"n-btn n-btn-success btn-round",onOk:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"PC")},onCancel:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"AC")},headerText:!1,showClose:!0};jConfirm("Выберите способ оплаты",c_ops,!0),$("#j_lead_confirm").find("#jConfirmOk").removeClass("ibtn wind-btn-apply")}else f_show_msg(frm);break;default:console.log("FORM has action type = "+data_mes_url+" (it is not defined)")}frm.find("input.inp,textarea.inp").val(""),frm.find("input[type=checkbox]").prop("checked",!1),frm.find(".fradio input:first").prop("checked",!0),frm.find(".fselect option:first").prop("selected","selected"),frm.find("input[type=file]").val(null).trigger("change",e);var w=frm.closest(".wind");if(w.length&&w.wind("hide"),w=null,!1!==mes){if(window.jAlert){var wnd_width="undefined"==typeof adapterManager||adapterManager.isPC()?400:340;$("#wind_container").addClass("j_alert"),jAlert(mes.replace(/\\n/g,"<br/>"),{id:"j_lead_alert",showCloseBtn:!0,btnCls:"btn",width:wnd_width,btnWidth:"auto",hideOnBlackoutClick:!0,html:!0,onOk:function(){$("#wind_container").removeClass("j_alert")}})}else alert(mes.replace(/\\n/g,"\n"));mes=null}}else if(data.show_alert)switch(data.show_alert){case"empty_data":alert("Нужно заполнить хотя бы одно поле");break;default:alert("Error: "+data.show_alert)}window.dbgMode&&console.log(data)},error:function(e,t,i){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(i))}frm.find("input.ui_btn, input.btn-submit").button("def")}};if(frm.find("input[type=file]").length>0){if(!window.FormData)return alert("Ошибка № 2876 Ваш браузер не поддерживает объект FormData, попробуйте воспользоваться современной версией браузера"),!1;ajax_cfg.data=new FormData(this),ajax_cfg.processData=!1,ajax_cfg.contentType=!1}else ajax_cfg.dataType="json",ajax_cfg.data=$(this).serialize();return $.ajax(ajax_cfg),id=null,!1}),window._eh={step:20,speed:300,$container:!1,$body:!1,$wnd:!1,bodyWidth:0,$img:null,$newImg:null,curSize:null,origSize:null,wndSize:null,newSize:null},window._lpcid_hosts=["http://lpmotor.ru","http://lpmotor.org","http://bm360.ru","https://admin.lpmotor.ru"],window.userHasTag=function(e){return void 0!==window.__user_tags&&void 0!==window.__user_tags[e]},window.userAddTag=function(e,t){void 0!==window.__user_tags&&void 0===window.__user_tags[e]&&window.$&&$.ajax({url:baseUrl+"tests/ajax/do:add_tag",data:{tag:e},dataType:"json",method:"post",_funcParams:{callback:t||!1},success:function(t){var i=!1;t.res&&1==t.res&&t.cnt&&t.cnt>0&&(window.__user_tags[e]=1,i=!0),"function"==typeof this._funcParams.callback&&this._funcParams.callback.apply(this,[i,t])}})},function(e){"use strict";function t(t){e(n).each(function(){FE.run("hide_custom_dropdown",t,{$btn:e(this),$wrap:i(e(this)).removeClass("open")})})}function i(e){return e.parent()}var n=".custom-dropdown-btn",a="click.custom-dropdown.data-api",o=function(t){var i=e(t).on(a,this.toggle);e("html").on(a,function(e){FE.run("hide_custom_dropdown",e,{$btn:i,$wrap:i.parent().removeClass("open")})})};o.prototype={constructor:o,toggle:function(n){var a,o,s=e(this);if(!s.is(".disabled, :disabled"))return a=i(s),o=a.hasClass("open"),t(n),o||(document.documentElement,FE.run("show_custom_dropdown",n,{$btn:s,$wrap:a.toggleClass("open")})),s.focus(),!1},keydown:function(t){var a,o,s;if(/(38|40|27)/.test(t.keyCode)&&(a=e(this),t.preventDefault(),t.stopPropagation(),!a.is(".disabled, :disabled")))return o=i(a),s=o.hasClass("open"),!s||s&&27==t.keyCode?(27==t.which&&o.find(n).focus(),a.click()):void 0}};var s=e.fn.customDropdown;e.fn.customDropdown=function(t){return this.each(function(){var i=e(this),n=i.data("customDropdown");n||i.data("customDropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})},e.fn.customDropdown.Constructor=o,e.fn.customDropdown.noConflict=function(){return e.fn.customDropdown=s,this},e(document).on(a,t).on(a,".custom-dropdown-menu",function(e){e.stopPropagation()}).on(a,n,o.prototype.toggle).on("keydown.custom-dropdown.data-api",n,o.prototype.keydown)}(window.jQuery),function(){$("#popup_list").on("click",".blk_section.section_popup.open",function(e){if("click"==e.type&&$(e.target).hasClass("section_popup"))return hideSectionPopup($(e.currentTarget).attr("id")),!1})}(),function(){var e=function(){var e=$("#gift-for-user img");if(e.length>0){var t=e.attr("classes-animate");e.addClass(t);var i=function(){e.removeClass(t)};setTimeout(i,1e3)}};$("#gift-for-user").length>0&&setInterval(e,3e3)}(),Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI},window._wind_cnt=0,F_wind.prototype.toggle=function(){return this[this.isShown?"hide":"show"]()},F_wind.prototype.show=function(){if(this.ops.showFunc(this)){window._wind_cnt<=0&&($("#wind_container").show(),window._wind_cnt<0&&(window._wind_cnt=0)),this.$el.parent().hasClass("wind-wrap")?this.$wrap||(this.$wrap=this.$el.closest(".wind-wrap")):(this.$el.wrap('<div class="wind-wrap hidden'+(this.whiteBg?" wind-wrap-white":"")+'"></div>'),this.$el.removeClass("hidden"),this.$wrap=this.$el.parent()),this.$wrap.css({"z-index":window._wind_cnt+1}),this.$wrap.removeClass("hidden"),this.isShown=!0,this.$el.trigger("show");var e=$("body").width(),t=null;$("html").addClass("wind_opened"),t=$("body").width()-e,$("body").css("margin-right",t),$("body>.navbar>.navbar-inner").css("padding-right",t),e=t=null,window._wind_cnt++}},F_wind.prototype.hide=function(){window._wind_cnt>0?window._wind_cnt--:window._wind_cnt=0,this.$wrap.addClass("hidden"),0==$("#wind_container > div:visible").length&&$("#wind_container").hide(),this.isShown=!1,this.$el.trigger("hide"),$("body").css("margin-right",0),$("body>.navbar>.navbar-inner").css("padding-right",0),$("html").removeClass("wind_opened"),this.ops.afterCloseFunc(this)},F_wind.prototype.setHidePrevWnd=function(e){this.hidePrevWnd=!!e},F_wind.prototype.setWhiteBg=function(e){this.whiteBg=!!e},F_wind.prototype.setApplyFunc=function(e){"function"==typeof e&&(this.ops.applyFunc=e)},F_wind.prototype.setCancelFunc=function(e){"function"==typeof e&&(this.ops.cancelFunc=e)},F_wind.prototype.setCloseFunc=function(e){this.ops.closeFunc="function"==typeof e?e:null},F_wind.prototype.setAfterCloseFunc=function(e){"function"==typeof e&&(this.ops.afterCloseFunc=e)},F_wind.prototype.setShowFunc=function(e){"function"==typeof e&&(this.ops.showFunc=e)},F_wind.prototype.setParams=function(e){this.params=e},F_wind.prototype.clickBtnApply=function(){!1!==this.ops.applyFunc(this)&&this.hide()},F_wind.prototype.clickBtnClose=function(){"function"==typeof this.ops.closeFunc?!1!==this.ops.closeFunc(this)&&this.hide():this.clickBtnCancel()},F_wind.prototype.clickBtnCancel=function(){!1!==this.ops.cancelFunc(this)&&this.hide()},jQuery.fn.wind=function(e){var t=$(this),i=$.extend({},$.fn.wind.defaults,"object"==typeof e&&e),n=t.data("wind");return n||t.data("wind",n=new F_wind(this,i)),"string"==typeof e?arguments[1]?n[e](arguments[1]):n[e]():i.show&&n.show(),t=n=i=null,this},jQuery.fn.wind.defaults={show:!1,container:$("body > #wind_container"),applyFunc:function(){return!0},cancelFunc:function(){return!0},closeFunc:null,showFunc:function(){return!0},afterCloseFunc:function(){}},fotoramaVersion="4.6.4",function(e,t,i,n,a){"use strict";function o(){}function s(e,t,i){return Math.max(isNaN(t)?-1/0:t,Math.min(isNaN(i)?1/0:i,e))}function r(e){return e.match(/ma/)&&e.match(/-?\d+(?!d)/g)[e.match(/3d/)?12:4]}function l(e){return It?+r(e.css("transform")):+e.css("left").replace("px","")}function d(e){var t={};return It?t.transform="translate3d("+e+"px,0,0)":t.left=e,t}function c(e){return{"transition-duration":e+"ms"}}function u(e,t){return isNaN(e)?t:e}function f(e,t){return u(+String(e).replace(t||"px",""))}function p(e){return/%$/.test(e)?f(e,"%"):a}function h(e,t){return u(p(e)/100*t,f(e))}function m(e){return(!isNaN(f(e))||!isNaN(f(e,"%")))&&e}function _(e,t,i,n){return(e-(n||0))*(t+(i||0))}function w(e,t,i,n){return-Math.round(e/(t+(i||0))-(n||0))}function g(e){var t=e.data();t.tEnd||(W(e[0],{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"}[vt.prefixed("transition")],function(e){t.tProp&&e.propertyName.match(t.tProp)&&t.onEndFn()}),t.tEnd=!0)}function v(e,t,i,n){var a,o=e.data();o&&(o.onEndFn=function(){a||(a=!0,clearTimeout(o.tT),i())},o.tProp=t,clearTimeout(o.tT),o.tT=setTimeout(function(){o.onEndFn()},1.5*n),g(e))}function b(e,t){if(e.length){var i=e.data();It?(e.css(c(0)),i.onEndFn=o,clearTimeout(i.tT)):e.stop();var n=y(t,function(){return l(e)});return e.css(d(n)),n}}function y(){for(var e,t=0,i=arguments.length;i>t&&"number"!=typeof(e=t?arguments[t]():arguments[t]);t++);return e}function $(e,t){return Math.round(e+(t-e)/1.5)}function k(){return k.p=k.p||("https:"===i.protocol?"https://":"http://"),k.p}function x(e){var i=t.createElement("a");return i.href=e,i}function C(e,t){if("string"!=typeof e)return e;e=x(e);var i,n;if(e.host.match(/youtube\.com/)&&e.search){if(i=e.search.split("v=")[1]){var a=i.indexOf("&");-1!==a&&(i=i.substring(0,a)),n="youtube"}}else e.host.match(/youtube\.com|youtu\.be/)?(i=e.pathname.replace(/^\/(embed\/|v\/)?/,"").replace(/\/.*/,""),n="youtube"):e.host.match(/vimeo\.com/)&&(n="vimeo",i=e.pathname.replace(/^\/(video\/)?/,"").replace(/\/.*/,""));return i&&n||!t||(i=e.href,n="custom"),!!i&&{id:i,type:n,s:e.search.replace(/^\?/,""),p:k()}}function S(e,t,i){var a,o,s=e.video;return"youtube"===s.type?(o=k()+"img.youtube.com/vi/"+s.id+"/default.jpg",a=o.replace(/\/default.jpg$/,"/hqdefault.jpg"),e.thumbsReady=!0):"vimeo"===s.type?n.ajax({url:k()+"vimeo.com/api/v2/video/"+s.id+".json",dataType:"jsonp",success:function(n){e.thumbsReady=!0,T(t,{img:n[0].thumbnail_large,thumb:n[0].thumbnail_small},e.i,i)}}):e.thumbsReady=!0,{img:a,thumb:o}}function T(e,t,i,a){for(var o=0,s=e.length;s>o;o++){var r=e[o];if(r.i===i&&r.thumbsReady){var l={videoReady:!0};l[Gt]=l[Kt]=l[Qt]=!1,a.splice(o,1,n.extend({},r,l,t));break}}}function M(e){function t(e,t,a){var o=e.children("img").eq(0),s=e.attr("href"),r=e.attr("src"),l=o.attr("src"),d=t.video,c=!!a&&C(s,d===!0);c?s=!1:c=d,i(e,o,n.extend(t,{video:c,img:t.img||s||r||l,thumb:t.thumb||l||r||s}))}function i(e,t,i){var a=i.thumb&&i.img!==i.thumb,o=f(i.width||e.attr("width")),s=f(i.height||e.attr("height"));n.extend(i,{width:o,height:s,thumbratio:H(i.thumbratio||f(i.thumbwidth||t&&t.attr("width")||a||o)/f(i.thumbheight||t&&t.attr("height")||a||s))})}var a=[];return e.children().each(function(){var e=n(this),o=R(n.extend(e.data(),{id:e.attr("id")}));if(e.is("a, img"))t(e,o,!0);else{if(e.is(":empty"))return;i(e,null,n.extend(o,{html:this,_html:e.html()}))}a.push(o)}),a}function E(e){return 0===e.offsetWidth&&0===e.offsetHeight}function j(e){return!n.contains(t.documentElement,e)}function F(e,t,i,n){return F.i||(F.i=1,F.ii=[!0]),n=n||F.i,void 0===F.ii[n]&&(F.ii[n]=!0),e()?t():F.ii[n]&&setTimeout(function(){F.ii[n]&&F(e,t,i,n)},i||100),F.i++}function P(e){i.replace(i.protocol+"//"+i.host+i.pathname.replace(/^\/?/,"/")+i.search+"#"+e)}function I(e,t,i,n){var a=e.data(),o=a.measures;if(o&&(!a.l||a.l.W!==o.width||a.l.H!==o.height||a.l.r!==o.ratio||a.l.w!==t.w||a.l.h!==t.h||a.l.m!==i||a.l.p!==n)){var r=o.width,l=o.height,d=t.w/t.h,c=o.ratio>=d,u="scaledown"===i,f="contain"===i,p="cover"===i,m=J(n);c&&(u||f)||!c&&p?(r=s(t.w,0,u?r:1/0),l=r/o.ratio):(c&&p||!c&&(u||f))&&(l=s(t.h,0,u?l:1/0),r=l*o.ratio),e.css({width:r,height:l,left:h(m.x,t.w-r),top:h(m.y,t.h-l)}),a.l={W:o.width,H:o.height,r:o.ratio,w:t.w,h:t.h,m:i,p:n}}return!0}function O(e,t){var i=e[0];i.styleSheet?i.styleSheet.cssText=t:e.html(t)}function D(e,t,i){return t!==i&&(t>=e?"left":e>=i?"right":"left right")}function L(e,t,i,n){if(!i)return!1;if(!isNaN(e))return e-(n?0:1);for(var a,o=0,s=t.length;s>o;o++)if(t[o].id===e){a=o;break}return a}function N(e,t,i){i=i||{},e.each(function(){var e,a=n(this),s=a.data();s.clickOn||(s.clickOn=!0,n.extend(te(a,{onStart:function(t){e=t,(i.onStart||o).call(this,t)},onMove:i.onMove||o,onTouchEnd:i.onTouchEnd||o,onEnd:function(i){i.moved||t.call(this,e)}}),{noMove:!0}))})}function z(e,t){return'<div class="'+e+'">'+(t||"")+"</div>"}function A(e){for(var t=e.length;t;){var i=Math.floor(Math.random()*t--),n=e[t];e[t]=e[i],e[i]=n}return e}function B(e){return"[object Array]"==Object.prototype.toString.call(e)&&n.map(e,function(e){
return n.extend({},e)})}function U(e,t,i){e.scrollLeft(t||0).scrollTop(i||0)}function R(e){if(e){var t={};return n.each(e,function(e,i){t[e.toLowerCase()]=i}),t}}function H(e){if(e){var t=+e;return isNaN(t)?(t=e.split("/"),+t[0]/+t[1]||a):t}}function W(e,t,i,n){t&&(e.addEventListener?e.addEventListener(t,i,!!n):e.attachEvent("on"+t,i))}function q(e){return!!e.getAttribute("disabled")}function V(e){return{tabindex:-1*e+"",disabled:e}}function G(e,t){W(e,"keyup",function(i){q(e)||13==i.keyCode&&t.call(e,i)})}function Q(e,t){W(e,"focus",e.onfocusin=function(i){t.call(e,i)},!0)}function K(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&e.stopPropagation&&e.stopPropagation()}function Y(e){return e?">":"<"}function J(e){return e=(e+"").split(/\s+/),{x:m(e[0])||Xt,y:m(e[1])||Xt}}function X(e,t){var i=e.data(),a=Math.round(t.pos),s=function(){i.sliding=!1,(t.onEnd||o)()};void 0!==t.overPos&&t.overPos!==t.pos&&(a=t.overPos,s=function(){X(e,n.extend({},t,{overPos:t.pos,time:Math.max(Ut,t.time/2)}))});var r=n.extend(d(a),t.width&&{width:t.width});i.sliding=!0,It?(e.css(n.extend(c(t.time),r)),t.time>10?v(e,"transform",s,t.time):s()):e.stop().animate(r,t.time,Jt,s)}function Z(e,t,i,a,s,r){var l=void 0!==r;if(l||(s.push(arguments),Array.prototype.push.call(arguments,s.length),!(s.length>1))){e=e||n(e),t=t||n(t);var d=e[0],c=t[0],u="crossfade"===a.method,f=function(){if(!f.done){f.done=!0;var e=(l||s.shift())&&s.shift();e&&Z.apply(this,e),(a.onEnd||o)(!!e)}},p=a.time/(r||1);i.removeClass(Re+" "+Ue),e.stop().addClass(Re),t.stop().addClass(Ue),u&&c&&e.fadeTo(0,0),e.fadeTo(u?p:0,1,u&&f),t.fadeTo(p,0,f),d&&u||c||f()}}function ee(e){var t=(e.touches||[])[0]||e;e._x=t.pageX,e._y=t.clientY,e._now=n.now()}function te(e,i){function a(e){return f=n(e.target),b.checked=m=_=g=!1,c||b.flow||e.touches&&e.touches.length>1||e.which>1||ti&&ti.type!==e.type&&ni||(m=i.select&&f.is(i.select,v))?m:(h="touchstart"===e.type,_=f.is("a, a *",v),p=b.control,w=b.noMove||b.noSwipe||p?16:b.snap?0:4,ee(e),u=ti=e,ii=e.type.replace(/down|start/,"move").replace(/Down/,"Move"),(i.onStart||o).call(v,e,{control:p,$target:f}),c=b.flow=!0,void((!h||b.go)&&K(e)))}function s(e){if(e.touches&&e.touches.length>1||zt&&!e.isPrimary||ii!==e.type||!c)return c&&r(),void(i.onTouchEnd||o)();ee(e);var t=Math.abs(e._x-u._x),n=Math.abs(e._y-u._y),a=t-n,s=(b.go||b.x||a>=0)&&!b.noSwipe,l=0>a;h&&!b.checked?(c=s)&&K(e):(K(e),(i.onMove||o).call(v,e,{touch:h})),!g&&Math.sqrt(Math.pow(t,2)+Math.pow(n,2))>w&&(g=!0),b.checked=b.checked||s||l}function r(e){(i.onTouchEnd||o)();var t=c;b.control=c=!1,t&&(b.flow=!1),!t||_&&!b.checked||(e&&K(e),ni=!0,clearTimeout(ai),ai=setTimeout(function(){ni=!1},1e3),(i.onEnd||o).call(v,{moved:g,$target:f,control:p,touch:h,startEvent:u,aborted:!e||"MSPointerCancel"===e.type}))}function l(){b.flow||setTimeout(function(){b.flow=!0},10)}function d(){b.flow&&setTimeout(function(){b.flow=!1},Bt)}var c,u,f,p,h,m,_,w,g,v=e[0],b={};return zt?(W(v,"MSPointerDown",a),W(t,"MSPointerMove",s),W(t,"MSPointerCancel",r),W(t,"MSPointerUp",r)):(W(v,"touchstart",a),W(v,"touchmove",s),W(v,"touchend",r),W(t,"touchstart",l),W(t,"touchend",d),W(t,"touchcancel",d),Et.on("scroll",d),e.on("mousedown",a),jt.on("mousemove",s).on("mouseup",r)),e.on("click","a",function(e){b.checked&&K(e)}),b}function ie(e,t){function i(i,n){S=!0,c=u=i._x,_=i._now,m=[[_,c]],f=p=E.noMove||n?0:b(e,(t.getPos||o)()),(t.onStart||o).call(T,i)}function a(e,t){g=E.min,v=E.max,y=E.snap,k=e.altKey,S=C=!1,(x=t.control)||M.sliding||i(e)}function r(n,a){E.noSwipe||(S||i(n),u=n._x,m.push([n._now,u]),p=f-(c-u),h=D(p,g,v),g>=p?p=$(p,g):p>=v&&(p=$(p,v)),E.noMove||(e.css(d(p)),C||(C=!0,a.touch||zt||e.addClass(nt)),(t.onMove||o).call(T,n,{pos:p,edge:h})))}function l(a){if(!E.noSwipe||!a.moved){S||i(a.startEvent,!0),a.touch||zt||e.removeClass(nt),w=n.now();for(var r,l,d,c,h,_,b,$,x,C=w-Bt,M=null,j=Ut,F=t.friction,P=m.length-1;P>=0;P--){if(r=m[P][0],l=Math.abs(r-C),null===M||d>l)M=r,c=m[P][1];else if(M===C||l>d)break;d=l}b=s(p,g,v);var I=c-u,O=I>=0,D=w-M,L=D>Bt,N=!L&&p!==f&&b===p;y&&(b=s(Math[N?O?"floor":"ceil":"round"](p/y)*y,g,v),g=v=b),N&&(y||b===p)&&(x=-(I/D),j*=s(Math.abs(x),t.timeLow,t.timeHigh),h=Math.round(p+x*j/F),y||(b=h),(!O&&h>v||O&&g>h)&&(_=O?g:v,$=h-_,y||(b=_),$=s(b+.03*$,_-50,_+50),j=Math.abs((p-$)/(x/F)))),j*=k?10:1,(t.onEnd||o).call(T,n.extend(a,{moved:a.moved||L&&y,pos:p,newPos:b,overPos:$,time:j}))}}var c,u,f,p,h,m,_,w,g,v,y,k,x,C,S,T=e[0],M=e.data(),E={};return E=n.extend(te(t.$wrap,n.extend({},t,{onStart:a,onMove:r,onEnd:l})),E)}function ne(e,t){var i,a,s,r=e[0],l={prevent:{}};return W(r,At,function(e){var r=e.wheelDeltaY||-1*e.deltaY||0,d=e.wheelDeltaX||-1*e.deltaX||0,c=Math.abs(d)&&!Math.abs(r),u=Y(0>d),f=a===u,p=n.now(),h=Bt>p-s;a=u,s=p,c&&l.ok&&(!l.prevent[u]||i)&&(K(e,!0),i&&f&&h||(t.shift&&(i=!0,clearTimeout(l.t),l.t=setTimeout(function(){i=!1},Rt)),(t.onEnd||o)(e,t.shift?u:d)))}),l}function ae(){n.each(n.Fotorama.instances,function(e,t){t.index=e})}function oe(e){n.Fotorama.instances.push(e),ae()}function se(e){n.Fotorama.instances.splice(e.index,1),ae()}var re="fotorama",le="fullscreen",de=re+"__wrap",ce=de+"--css2",ue=de+"--css3",fe=de+"--video",pe=de+"--fade",he=de+"--slide",me=de+"--no-controls",_e=de+"--no-shadows",we=de+"--pan-y",ge=de+"--rtl",ve=de+"--only-active",be=de+"--no-captions",ye=de+"--toggle-arrows",$e=re+"__stage",ke=$e+"__frame",xe=ke+"--video",Ce=$e+"__shaft",Se=re+"__grab",Te=re+"__pointer",Me=re+"__arr",Ee=Me+"--disabled",je=Me+"--prev",Fe=Me+"--next",Pe=re+"__nav",Ie=Pe+"-wrap",Oe=Pe+"__shaft",De=Pe+"--dots",Le=Pe+"--thumbs",Ne=Pe+"__frame",ze=Ne+"--dot",Ae=Ne+"--thumb",Be=re+"__fade",Ue=Be+"-front",Re=Be+"-rear",He=re+"__shadow",We=He+"s",qe=We+"--left",Ve=We+"--right",Ge=re+"__active",Qe=re+"__select",Ke=re+"--hidden",Ye=re+"--fullscreen",Je=re+"__fullscreen-icon",Xe=re+"__error",Ze=re+"__loading",et=re+"__loaded",tt=et+"--full",it=et+"--img",nt=re+"__grabbing",at=re+"__img",ot=at+"--full",st=re+"__dot",rt=re+"__thumb",lt=rt+"-border",dt=re+"__html",ct=re+"__video",ut=ct+"-play",ft=ct+"-close",pt=re+"__caption",ht=re+"__caption__wrap",mt=re+"__spinner",_t='" tabindex="0" role="button',wt=n&&n.fn.jquery.split(".");if(!wt||wt[0]<1||1==wt[0]&&wt[1]<8)throw"Fotorama requires jQuery 1.8 or later and will not run without it.";var gt={},vt=function(e,t,i){function n(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var o=e[n];if(!a(o,"-")&&h[o]!==i)return"pfx"!=t||o}return!1}function s(e,t,a){for(var o in e){var s=t[e[o]];if(s!==i)return a===!1?e[o]:n(s,"function")?s.bind(a||t):s}return!1}function r(e,t,i){var a=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+w.join(a+" ")+a).split(" ");return n(t,"string")||n(t,"undefined")?o(r,t):(r=(e+" "+g.join(a+" ")+a).split(" "),s(r,t,i))}var l,d,c={},u=t.documentElement,f="modernizr",p=t.createElement(f),h=p.style,m=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),_="Webkit Moz O ms",w=_.split(" "),g=_.toLowerCase().split(" "),v={},b=[],y=b.slice,$=function(e,i,n,a){var o,s,r,l,d=t.createElement("div"),c=t.body,p=c||t.createElement("body");if(parseInt(n,10))for(;n--;)r=t.createElement("div"),r.id=a?a[n]:f+(n+1),d.appendChild(r);return o=["&#173;",'<style id="s',f,'">',e,"</style>"].join(""),d.id=f,(c?d:p).innerHTML+=o,p.appendChild(d),c||(p.style.background="",p.style.overflow="hidden",l=u.style.overflow,u.style.overflow="hidden",u.appendChild(p)),s=i(d,e),c?d.parentNode.removeChild(d):(p.parentNode.removeChild(p),u.style.overflow=l),!!s},k={}.hasOwnProperty;d=n(k,"undefined")||n(k.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(e,t){return k.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=y.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var o=new a,s=t.apply(o,i.concat(y.call(arguments)));return Object(s)===s?s:o}return t.apply(e,i.concat(y.call(arguments)))};return n}),v.csstransforms3d=function(){return!!r("perspective")};for(var x in v)d(v,x)&&(l=x.toLowerCase(),c[l]=v[x](),b.push((c[l]?"":"no-")+l));return c.addTest=function(e,t){if("object"==typeof e)for(var n in e)d(e,n)&&c.addTest(n,e[n]);else{if(e=e.toLowerCase(),c[e]!==i)return c;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(u.className+=" "+(t?"":"no-")+e),c[e]=t}return c},function(e){h.cssText=""}(),p=null,c._version="2.6.2",c._prefixes=m,c._domPrefixes=g,c._cssomPrefixes=w,c.testProp=function(e){return o([e])},c.testAllProps=r,c.testStyles=$,c.prefixed=function(e,t,i){return t?r(e,t,i):r(e,"pfx")},c}(0,t),bt={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:"",prefix:""},yt="webkit moz o ms khtml".split(" ");if(void 0!==t.cancelFullScreen)bt.ok=!0;else for(var $t=0,kt=yt.length;kt>$t;$t++)if(bt.prefix=yt[$t],void 0!==t[bt.prefix+"CancelFullScreen"]){bt.ok=!0;break}bt.ok&&(bt.event=bt.prefix+"fullscreenchange",bt.is=function(){switch(this.prefix){case"":return t.fullScreen;case"webkit":return t.webkitIsFullScreen;default:return t[this.prefix+"FullScreen"]}},bt.request=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},bt.cancel=function(){return""===this.prefix?t.cancelFullScreen():t[this.prefix+"CancelFullScreen"]()});var xt,Ct={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:"rgba(128, 128, 128, .75)",hwaccel:!0},St={top:"auto",left:"auto",className:""};!function(e,t){xt=function(){function e(e,i){var n,a=t.createElement(e||"div");for(n in i)a[n]=i[n];return a}function i(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,i,n){var a=["opacity",t,~~(100*e),i,n].join("-"),o=.01+i/n*100,s=Math.max(1-(1-e)/t*(100-o),e),r=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=r&&"-"+r+"-"||"";return p[a]||(h.insertRule("@"+l+"keyframes "+a+"{0%{opacity:"+s+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+s+"}}",h.cssRules.length),p[a]=1),a}function o(e,t){var i,n,o=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<f.length;n++)if(i=f[n]+t,o[i]!==a)return i;return o[t]!==a?t:void 0}function s(e,t){for(var i in t)e.style[o(e,i)||i]=t[i];return e}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]===a&&(e[n]=i[n])}return e}function l(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function d(e,t){return"string"==typeof e?e:e[t%e.length]}function c(e){return void 0===this?new c(e):void(this.opts=r(e||{},c.defaults,m))}var u,f=["webkit","Moz","ms","O"],p={},h=function(){var n=e("style",{type:"text/css"});return i(t.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),m={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};c.defaults={},r(c.prototype,{spin:function(t){this.stop();var i,n,a=this,o=a.opts,r=a.el=s(e(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),d=o.radius+o.length+o.width;if(t&&(t.insertBefore(r,t.firstChild||null),n=l(t),i=l(r),s(r,{left:("auto"==o.left?n.x-i.x+(t.offsetWidth>>1):parseInt(o.left,10)+d)+"px",top:("auto"==o.top?n.y-i.y+(t.offsetHeight>>1):parseInt(o.top,10)+d)+"px"})),r.setAttribute("role","progressbar"),a.lines(r,a.opts),!u){var c,f=0,p=(o.lines-1)*(1-o.direction)/2,h=o.fps,m=h/o.speed,_=(1-o.opacity)/(m*o.trail/100),w=m/o.lines;!function e(){f++;for(var t=0;t<o.lines;t++)c=Math.max(1-(f+(o.lines-t)*w)%m*_,o.opacity),a.opacity(r,t*o.direction+p,c,o);a.timeout=a.el&&setTimeout(e,~~(1e3/h))}()}return a},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=a),this},lines:function(t,a){function o(t,i){return s(e(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*l+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var r,l=0,c=(a.lines-1)*(1-a.direction)/2;l<a.lines;l++)r=s(e(),{position:"absolute",top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:u&&n(a.opacity,a.trail,c+l*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&i(r,s(o("#000","0 0 4px #000"),{top:"2px"})),i(t,i(r,o(d(a.color,l),"0 0 1px rgba(0,0,0,.1)")));return t},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var _=s(e("group"),{behavior:"url(#default#VML)"});return!o(_,"transform")&&_.adj?function(){function t(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}h.addRule(".spin-vml","behavior:url(#default#VML)"),c.prototype.lines=function(e,n){function a(){return s(t("group",{coordsize:c+" "+c,coordorigin:-l+" "+-l}),{width:c,height:c})}function o(e,o,r){i(f,i(s(a(),{rotation:360/n.lines*e+"deg",left:~~o}),i(s(t("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:r}),t("fill",{color:d(n.color,e),opacity:n.opacity}),t("stroke",{opacity:0}))))}var r,l=n.length+n.width,c=2*l,u=2*-(n.width+n.length)+"px",f=s(a(),{position:"absolute",top:u,left:u});if(n.shadow)for(r=1;r<=n.lines;r++)o(r,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(r=1;r<=n.lines;r++)o(r);return i(e,f)},c.prototype.opacity=function(e,t,i,n){var a=e.firstChild;n=n.shadow&&n.lines||0,a&&t+n<a.childNodes.length&&(a=a.childNodes[t+n],a=a&&a.firstChild,(a=a&&a.firstChild)&&(a.opacity=i))}}():u=o(_,"animation"),c}()}();var Tt,Mt,Et=n(e),jt=n(t),Ft="quirks"===i.hash.replace("#",""),Pt=vt.csstransforms3d,It=Pt&&!Ft,Ot=Pt||"CSS1Compat"===t.compatMode,Dt=bt.ok,Lt=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),Nt=!It||Lt,zt=navigator.msPointerEnabled,At="onwheel"in t.createElement("div")?"wheel":t.onmousewheel!==a?"mousewheel":"DOMMouseScroll",Bt=250,Ut=300,Rt=1400,Ht=5e3,Wt=64,qt=500,Vt=333,Gt="$stageFrame",Qt="$navDotFrame",Kt="$navThumbFrame",Yt="auto",Jt=function(e){var t="bez_"+n.makeArray(arguments).join("_").replace(".","p");if("function"!=typeof n.easing[t]){var i=function(e,t){var i=[null,null],n=[null,null],a=[null,null],o=function(o,s){return a[s]=3*e[s],n[s]=3*(t[s]-e[s])-a[s],i[s]=1-a[s]-n[s],o*(a[s]+o*(n[s]+o*i[s]))},s=function(e){return a[0]+e*(2*n[0]+3*i[0]*e)},r=function(e){for(var t,i=e,n=0;++n<14&&(t=o(i,0)-e,!(Math.abs(t)<.001));)i-=t/s(i);return i};return function(e){return o(r(e),1)}};n.easing[t]=function(t,n,a,o,s){return o*i([e[0],e[1]],[e[2],e[3]])(n/s)+a}}return t}([.1,0,.25,1]),Xt="50%",Zt={width:null,minwidth:null,maxwidth:"100%",height:null,minheight:null,maxheight:null,ratio:null,margin:2,glimpse:0,fit:"contain",position:Xt,thumbposition:Xt,nav:"dots",navposition:"bottom",navwidth:null,thumbwidth:Wt,thumbheight:Wt,thumbmargin:2,thumbborderwidth:2,thumbfit:"cover",allowfullscreen:!1,transition:"slide",clicktransition:null,transitionduration:Ut,captions:!0,hash:!1,startindex:0,loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!0,trackpad:!1,enableifsingleframe:!1,controlsonstart:!0,shuffle:!1,direction:"ltr",shadows:!0,spinner:null},ei={left:!0,right:!0,down:!1,up:!1,space:!1,home:!1,end:!1};F.stop=function(e){F.ii[e]=!1};var ti,ii,ni,ai;jQuery.Fotorama=function(e,a){function o(){n.each(ki,function(e,t){if(!t.i){t.i=fn++;var i=C(t.video,!0);if(i){var n={};t.video=i,t.img||t.thumb?t.thumbsReady=!0:n=S(t,ki,ln),T(ki,{img:n.img,thumb:n.thumb},t.i,ln)}}})}function r(e){return Yi[e]||ln.fullScreen}function l(e){var t="keydown."+re,i=re+dn,n="keydown."+i,o="resize."+i+" orientationchange."+i;e?(jt.on(n,function(e){var t,i;Ti&&27===e.keyCode?(t=!0,ui(Ti,!0,!0)):(ln.fullScreen||a.keyboard&&!ln.index)&&(27===e.keyCode?(t=!0,ln.cancelFullScreen()):e.shiftKey&&32===e.keyCode&&r("space")||37===e.keyCode&&r("left")||38===e.keyCode&&r("up")?i="<":32===e.keyCode&&r("space")||39===e.keyCode&&r("right")||40===e.keyCode&&r("down")?i=">":36===e.keyCode&&r("home")?i="<<":35===e.keyCode&&r("end")&&(i=">>")),(t||i)&&K(e),i&&ln.show({index:i,slow:e.altKey,user:!0})}),ln.index||jt.off(t).on(t,"textarea, input, select",function(e){!Mt.hasClass(le)&&e.stopPropagation()}),Et.on(o,ln.resize)):(jt.off(n),Et.off(o))}function u(t){t!==u.f&&(t?(e.html("").addClass(re+" "+cn).append(_n).before(hn).before(mn),oe(ln)):(_n.detach(),hn.detach(),mn.detach(),e.html(pn.urtext).removeClass(cn),se(ln)),l(t),u.f=t)}function p(){ki=ln.data=ki||B(a.data)||M(e),xi=ln.size=ki.length,!$i.ok&&a.shuffle&&A(ki),o(),Dn=x(Dn),xi&&u(!0)}function g(){var e=2>xi&&!a.enableifsingleframe||Ti;zn.noMove=e||Hi,zn.noSwipe=e||!a.swipe,!Gi&&gn.toggleClass(Se,!a.click&&!zn.noMove&&!zn.noSwipe),zt&&_n.toggleClass(we,!zn.noSwipe)}function v(e){e===!0&&(e=""),a.autoplay=Math.max(+e||Ht,1.5*Vi)}function $(){function e(e,i){t[e?"add":"remove"].push(i)}ln.options=a=R(a),Hi="crossfade"===a.transition||"dissolve"===a.transition,Ni=a.loop&&(xi>2||Hi&&(!Gi||"slide"!==Gi)),Vi=+a.transitionduration||Ut,Ki="rtl"===a.direction,Yi=n.extend({},a.keyboard&&ei,a.keyboard);var t={add:[],remove:[]};xi>1||a.enableifsingleframe?(zi=a.nav,Bi="top"===a.navposition,t.remove.push(Qe),$n.toggle(!!a.arrows)):(zi=!1,$n.hide()),He(),Si=new xt(n.extend(Ct,a.spinner,St,{direction:Ki?-1:1})),Pt(),Lt(),a.autoplay&&v(a.autoplay),Wi=f(a.thumbwidth)||Wt,qi=f(a.thumbheight)||Wt,An.ok=Un.ok=a.trackpad&&!Nt,g(),ni(a,[Nn]),Ai="thumbs"===zi,Ai?(wt(xi,"navThumb"),Ci=Tn,rn=Kt,O(hn,n.Fotorama.jst.style({w:Wi,h:qi,b:a.thumbborderwidth,m:a.thumbmargin,s:dn,q:!Ot})),xn.addClass(Le).removeClass(De)):"dots"===zi?(wt(xi,"navDot"),Ci=Sn,rn=Qt,xn.addClass(De).removeClass(Le)):(zi=!1,xn.removeClass(Le+" "+De)),zi&&(Bi?kn.insertBefore(wn):kn.insertAfter(wn),$t.nav=!1,$t(Ci,Cn,"nav")),Ui=a.allowfullscreen,Ui?(En.prependTo(wn),Ri=Dt&&"native"===Ui):(En.detach(),Ri=!1),e(Hi,pe),e(!Hi,he),e(!a.captions,be),e(Ki,ge),e("always"!==a.arrows,ye),Qi=a.shadows&&!Nt,e(!Qi,_e),_n.addClass(t.add.join(" ")).removeClass(t.remove.join(" ")),Ln=n.extend({},a)}function k(e){return 0>e?(xi+e%xi)%xi:e>=xi?e%xi:e}function x(e){return s(e,0,xi-1)}function E(e){return Ni?k(e):x(e)}function q(e){return!!(e>0||Ni)&&e-1}function J(e){return!!(xi-1>e||Ni)&&e+1}function ee(){zn.min=Ni?-1/0:-_(xi-1,Nn.w,a.margin,ji),zn.max=Ni?1/0:-_(0,Nn.w,a.margin,ji),zn.snap=Nn.w+a.margin}function te(){Bn.min=Math.min(0,Nn.nw-Cn.width()),Bn.max=0,Cn.toggleClass(Se,!(Bn.noMove=Bn.min===Bn.max))}function ae(e,t,i){if("number"==typeof e){e=new Array(e);var a=!0}return n.each(e,function(e,n){if(a&&(n=e),"number"==typeof n){var o=ki[k(n)];if(o){var s="$"+t+"Frame",r=o[s];i.call(this,e,n,o,r,s,r&&r.data())}}})}function Be(e,t,i,n){(!Ji||"*"===Ji&&n===Li)&&(e=m(a.width)||m(e)||qt,t=m(a.height)||m(t)||Vt,ln.resize({width:e,ratio:a.ratio||i||e/t},0,n!==Li&&"*"))}function Ue(e,t,i,o,s,r){ae(e,t,function(e,l,d,c,u,f){function p(e){var t=k(l);ai(e,{index:t,src:$,frame:ki[t]})}function h(){v.remove(),n.Fotorama.cache[$]="error",d.html&&"stage"===t||!x||x===$?(!$||d.html||w?"stage"===t&&(c.trigger("f:load").removeClass(Ze+" "+Xe).addClass(et),p("load"),Be()):(c.trigger("f:error").removeClass(Ze).addClass(Xe),p("error")),f.state="error",!(xi>1&&ki[l]===d)||d.html||d.deleted||d.video||w||(d.deleted=!0,ln.splice(l,1))):(d[y]=$=x,Ue([l],t,i,o,s,!0))}function m(){n.Fotorama.measures[$]=b.measures=n.Fotorama.measures[$]||{width:g.width,height:g.height,ratio:g.width/g.height},Be(b.measures.width,b.measures.height,b.measures.ratio,l),v.off("load error").addClass(at+(w?" "+ot:"")).prependTo(c),I(v,(n.isFunction(i)?i():i)||Nn,o||d.fit||a.fit,s||d.position||a.position),n.Fotorama.cache[$]=f.state="loaded",setTimeout(function(){c.trigger("f:load").removeClass(Ze+" "+Xe).addClass(et+" "+(w?tt:it)),"stage"===t?p("load"):(d.thumbratio===Yt||!d.thumbratio&&a.thumbratio===Yt)&&(d.thumbratio=b.measures.ratio,bi())},0)}function _(){var e=10;F(function(){return!on||!e--&&!Nt},function(){m()})}if(c){var w=ln.fullScreen&&d.full&&d.full!==d.img&&!f.$full&&"stage"===t;if(!f.$img||r||w){var g=new Image,v=n(g),b=v.data();f[w?"$full":"$img"]=v;var y="stage"===t?w?"full":"img":"thumb",$=d[y],x=w?null:d["stage"===t?"thumb":"img"];if("navThumb"===t&&(c=f.$wrap),!$)return void h();n.Fotorama.cache[$]?function e(){"error"===n.Fotorama.cache[$]?h():"loaded"===n.Fotorama.cache[$]?setTimeout(_,0):setTimeout(e,100)}():(n.Fotorama.cache[$]="*",v.on("load",_).on("error",h)),f.state="",g.src=$}}})}function Re(e){On.append(Si.spin().el).appendTo(e)}function He(){On.detach(),Si&&Si.stop()}function nt(){var e=Mi[Gt];e&&!e.data().state&&(Re(e),e.on("f:load f:error",function(){e.off("f:load f:error"),He()}))}function ct(e){G(e,wi),Q(e,function(){setTimeout(function(){U(xn)},0),Jt({time:Vi,guessIndex:n(this).data().eq,minMax:Bn})})}function wt(e,t){ae(e,t,function(e,i,a,o,s,r){if(!o){o=a[s]=_n[s].clone(),r=o.data(),r.data=a;var l=o[0];"stage"===t?(a.html&&n('<div class="'+dt+'"></div>').append(a._html?n(a.html).removeAttr("id").html(a._html):a.html).appendTo(o),a.caption&&n(z(pt,z(ht,a.caption))).appendTo(o),a.video&&o.addClass(xe).append(Fn.clone()),Q(l,function(){setTimeout(function(){U(wn)},0),hi({index:r.eq,user:!0})}),vn=vn.add(o)):"navDot"===t?(ct(l),Sn=Sn.add(o)):"navThumb"===t&&(ct(l),r.$wrap=o.children(":first"),Tn=Tn.add(o),a.video&&r.$wrap.append(Fn.clone()))}})}function gt(e,t,i,n){return e&&e.length&&I(e,t,i,n)}function vt(e){ae(e,"stage",function(e,t,i,o,s,r){if(o){var l=k(t),d=i.fit||a.fit,u=i.position||a.position;r.eq=l,Hn[Gt][l]=o.css(n.extend({left:Hi?0:_(t,Nn.w,a.margin,ji)},Hi&&c(0))),j(o[0])&&(o.appendTo(gn),ui(i.$video)),gt(r.$img,Nn,d,u),gt(r.$full,Nn,d,u)}})}function yt(e,t){if("thumbs"===zi&&!isNaN(e)){var i=-e,o=-e+Nn.nw;Tn.each(function(){var e=n(this),s=e.data(),r=s.eq,l=function(){return{h:qi,w:s.w}},d=l(),c=ki[r]||{},u=c.thumbfit||a.thumbfit,f=c.thumbposition||a.thumbposition;d.w=s.w,s.l+s.w<i||s.l>o||gt(s.$img,d,u,f)||t&&Ue([r],"navThumb",l,u,f)})}}function $t(e,t,i){if(!$t[i]){var o="nav"===i&&Ai,s=0;t.append(e.filter(function(){for(var e,t=n(this),i=t.data(),a=0,o=ki.length;o>a;a++)if(i.data===ki[a]){e=!0,i.eq=a;break}return e||t.remove()&&!1}).sort(function(e,t){return n(e).data().eq-n(t).data().eq}).each(function(){if(o){var e=n(this),t=e.data(),i=Math.round(qi*t.data.thumbratio)||Wi;t.l=s,t.w=i,e.css({width:i}),s+=i+a.thumbmargin}})),$t[i]=!0}}function kt(e){return e-Wn>Nn.w/3}function Ft(e){return!(Ni||Dn+e&&Dn-xi+e||Ti)}function Pt(){var e=Ft(0),t=Ft(1);bn.toggleClass(Ee,e).attr(V(e)),yn.toggleClass(Ee,t).attr(V(t))}function Lt(){An.ok&&(An.prevent={"<":Ft(0),">":Ft(1)})}function At(e){var t,i,n=e.data();return Ai?(t=n.l,i=n.w):(t=e.position().left,i=e.width()),{c:t+i/2,min:-t+10*a.thumbmargin,max:-t+Nn.w-i-10*a.thumbmargin}}function Rt(e){var t=Mi[rn].data();X(Mn,{time:1.2*e,pos:t.l,width:t.w-2*a.thumbborderwidth})}function Jt(e){var t=ki[e.guessIndex][rn];if(t){var i=Bn.min!==Bn.max,n=e.minMax||i&&At(Mi[rn]),a=i&&(e.keep&&Jt.l?Jt.l:s((e.coo||Nn.nw/2)-At(t).c,n.min,n.max)),o=i&&s(a,Bn.min,Bn.max);X(Cn,{time:1.1*e.time,pos:o||0,onEnd:function(){yt(o,!0)}}),ci(xn,D(o,Bn.min,Bn.max)),Jt.l=a}}function Xt(){Zt(rn),Rn[rn].push(Mi[rn].addClass(Ge))}function Zt(e){for(var t=Rn[e];t.length;)t.shift().removeClass(Ge)}function ti(e){var t=Hn[e];n.each(Ei,function(e,i){delete t[k(i)]}),n.each(t,function(e,i){delete t[e],i.detach()})}function ii(e){ji=Fi=Dn;var t=Mi[Gt];t&&(Zt(Gt),Rn[Gt].push(t.addClass(Ge)),e||ln.show.onEnd(!0),b(gn,0,!0),ti(Gt),vt(Ei),ee(),te())}function ni(e,t){e&&n.each(t,function(t,i){i&&n.extend(i,{width:e.width||i.width,height:e.height,minwidth:e.minwidth,maxwidth:e.maxwidth,minheight:e.minheight,maxheight:e.maxheight,ratio:H(e.ratio)})})}function ai(t,i){e.trigger(re+":"+t,[ln,i])}function oi(){clearTimeout(si.t),on=1,a.stopautoplayontouch?ln.stopAutoplay():tn=!0}function si(){on&&(a.stopautoplayontouch||(ri(),li()),si.t=setTimeout(function(){on=0},Ut+Bt))}function ri(){tn=!(!Ti&&!nn)}function li(){if(clearTimeout(li.t),F.stop(li.w),!a.autoplay||tn)return void(ln.autoplay&&(ln.autoplay=!1,ai("stopautoplay")));ln.autoplay||(ln.autoplay=!0,ai("startautoplay"));var e=Dn,t=Mi[Gt].data();li.w=F(function(){return t.state||e!==Dn},function(){li.t=setTimeout(function(){if(!tn&&e===Dn){var t=Di,i=ki[t][Gt].data();li.w=F(function(){return i.state||t!==Di},function(){tn||t!==Di||ln.show(Ni?Y(!Ki):Di)})}},a.autoplay)})}function di(){ln.fullScreen&&(ln.fullScreen=!1,Dt&&bt.cancel(un),Mt.removeClass(le),Tt.removeClass(le),e.removeClass(Ye).insertAfter(mn),Nn=n.extend({},an),ui(Ti,!0,!0),_i("x",!1),ln.resize(),Ue(Ei,"stage"),U(Et,Zi,Xi),ai("fullscreenexit"))}function ci(e,t){Qi&&(e.removeClass(qe+" "+Ve),t&&!Ti&&e.addClass(t.replace(/^|\s/g," "+We+"--")))}function ui(e,t,i){t&&(_n.removeClass(fe),Ti=!1,g()),e&&e!==Ti&&(e.remove(),ai("unloadvideo")),i&&(ri(),li())}function fi(e){_n.toggleClass(me,e)}function pi(e){if(!zn.flow){var t=e?e.pageX:pi.x,i=t&&!Ft(kt(t))&&a.click;pi.p!==i&&wn.toggleClass(Te,i)&&(pi.p=i,pi.x=t)}}function hi(e){clearTimeout(hi.t),a.clicktransition&&a.clicktransition!==a.transition?setTimeout(function(){var t=a.transition;ln.setOptions({transition:a.clicktransition}),Gi=t,hi.t=setTimeout(function(){ln.show(e)},10)},0):ln.show(e)}function mi(e,t){var i=e.target;n(i).hasClass(ut)?ln.playVideo():i===jn?ln.toggleFullScreen():Ti?i===In&&ui(Ti,!0,!0):t?fi():a.click&&hi({index:e.shiftKey||Y(kt(e._x)),slow:e.altKey,user:!0})}function _i(e,t){zn[e]=Bn[e]=t}function wi(e){hi({index:n(this).data().eq,slow:e.altKey,user:!0,coo:e._x-xn.offset().left})}function gi(e){hi({index:$n.index(this)?">":"<",slow:e.altKey,user:!0})}function vi(e){Q(e,function(){setTimeout(function(){U(wn)},0),fi(!1)})}function bi(){if(p(),$(),!bi.i){bi.i=!0;var e=a.startindex;(e||a.hash&&i.hash)&&(Li=L(e||i.hash.replace(/^#/,""),ki,0===ln.index||e,e)),Dn=ji=Fi=Pi=Li=E(Li)||0}if(xi){if(yi())return;Ti&&ui(Ti,!0),Ei=[],ti(Gt),bi.ok=!0,ln.show({index:Dn,time:0}),ln.resize()}else ln.destroy()}function yi(){return!yi.f===Ki?(yi.f=Ki,Dn=xi-1-Dn,ln.reverse(),!0):void 0}function $i(){$i.ok||($i.ok=!0,ai("ready"))}Tt=n("html"),Mt=n("body");var ki,xi,Ci,Si,Ti,Mi,Ei,ji,Fi,Pi,Ii,Oi,Di,Li,Ni,zi,Ai,Bi,Ui,Ri,Hi,Wi,qi,Vi,Gi,Qi,Ki,Yi,Ji,Xi,Zi,en,tn,nn,an,on,sn,rn,ln=this,dn=n.now(),cn=re+dn,un=e[0],fn=1,pn=e.data(),hn=n("<style></style>"),mn=n(z(Ke)),_n=n(z(de)),wn=n(z($e)).appendTo(_n),gn=(wn[0],n(z(Ce)).appendTo(wn)),vn=n(),bn=n(z(Me+" "+je+_t)),yn=n(z(Me+" "+Fe+_t)),$n=bn.add(yn).appendTo(wn),kn=n(z(Ie)),xn=n(z(Pe)).appendTo(kn),Cn=n(z(Oe)).appendTo(xn),Sn=n(),Tn=n(),Mn=(gn.data(),Cn.data(),n(z(lt)).appendTo(Cn)),En=n(z(Je+_t)),jn=En[0],Fn=n(z(ut)),Pn=n(z(ft)).appendTo(wn),In=Pn[0],On=n(z(mt)),Dn=!1,Ln={},Nn={},zn={},An={},Bn={},Un={},Rn={},Hn={},Wn=0,qn=[];_n[Gt]=n(z(ke)),_n[Kt]=n(z(Ne+" "+Ae+_t,z(rt))),_n[Qt]=n(z(Ne+" "+ze+_t,z(st))),Rn[Gt]=[],Rn[Kt]=[],Rn[Qt]=[],Hn[Gt]={},_n.addClass(It?ue:ce).toggleClass(me,!a.controlsonstart),pn.fotorama=this,ln.startAutoplay=function(e){return ln.autoplay?this:(tn=nn=!1,v(e||a.autoplay),li(),this)},ln.stopAutoplay=function(){return ln.autoplay&&(tn=nn=!0,li()),this},ln.show=function(e){var t;"object"!=typeof e?(t=e,e={}):t=e.index,t=">"===t?Fi+1:"<"===t?Fi-1:"<<"===t?0:">>"===t?xi-1:t,t=isNaN(t)?L(t,ki,!0):t,t=void 0===t?Dn||0:t,ln.activeIndex=Dn=E(t),Ii=q(Dn),Oi=J(Dn),Di=k(Dn+(Ki?-1:1)),Ei=[Dn,Ii,Oi],Fi=Ni?t:Dn;var i=Math.abs(Pi-Fi),n=y(e.time,function(){return Math.min(Vi*(1+(i-1)/12),2*Vi)}),o=e.overPos;e.slow&&(n*=10);var r=Mi;ln.activeFrame=Mi=ki[Dn];var l=r===Mi&&!e.user;ui(Ti,Mi.i!==ki[k(ji)].i),wt(Ei,"stage"),vt(Nt?[Fi]:[Fi,q(Fi),J(Fi)]),_i("go",!0),l||ai("show",{user:e.user,time:n}),tn=!0;var d=ln.show.onEnd=function(t){if(!d.ok){if(d.ok=!0,t||ii(!0),l||ai("showend",{user:e.user}),!t&&Gi&&Gi!==a.transition)return ln.setOptions({transition:Gi}),void(Gi=!1);nt(),Ue(Ei,"stage"),_i("go",!1),Lt(),pi(),ri(),li()}};if(Hi?Z(Mi[Gt],Dn!==Pi?ki[Pi][Gt]:null,vn,{time:n,method:a.transition,onEnd:d},qn):X(gn,{pos:-_(Fi,Nn.w,a.margin,ji),overPos:o,time:n,onEnd:d}),Pt(),zi){Xt();var c=x(Dn+s(Fi-Pi,-1,1));Jt({time:n,coo:c!==Dn&&e.coo,guessIndex:void 0!==e.coo?c:Dn,keep:l}),Ai&&Rt(n)}return en=void 0!==Pi&&Pi!==Dn,Pi=Dn,a.hash&&en&&!ln.eq&&P(Mi.id||Dn+1),this},ln.requestFullScreen=function(){return Ui&&!ln.fullScreen&&(Xi=Et.scrollTop(),Zi=Et.scrollLeft(),U(Et),_i("x",!0),an=n.extend({},Nn),e.addClass(Ye).appendTo(Mt.addClass(le)),Tt.addClass(le),ui(Ti,!0,!0),ln.fullScreen=!0,Ri&&bt.request(un),ln.resize(),Ue(Ei,"stage"),nt(),ai("fullscreenenter")),this},ln.cancelFullScreen=function(){return Ri&&bt.is()?bt.cancel(t):di(),this},ln.toggleFullScreen=function(){return ln[(ln.fullScreen?"cancel":"request")+"FullScreen"]()},W(t,bt.event,function(){!ki||bt.is()||Ti||di()}),ln.resize=function(e){if(!ki)return this;var t=arguments[1]||0,i=arguments[2];ni(ln.fullScreen?{width:"100%",maxwidth:null,minwidth:null,height:"100%",maxheight:null,minheight:null}:R(e),[Nn,i||ln.fullScreen||a]);var n=Nn.width,o=Nn.height,r=Nn.ratio,l=Et.height()-(zi?xn.height():0);return m(n)&&(_n.addClass(ve).css({width:n,minWidth:Nn.minwidth||0,maxWidth:Nn.maxwidth||99999}),n=Nn.W=Nn.w=_n.width(),Nn.nw=zi&&h(a.navwidth,n)||n,a.glimpse&&(Nn.w-=Math.round(2*(h(a.glimpse,n)||0))),gn.css({width:Nn.w,marginLeft:(Nn.W-Nn.w)/2}),o=h(o,l),(o=o||r&&n/r)&&(n=Math.round(n),o=Nn.h=Math.round(s(o,h(Nn.minheight,l),h(Nn.maxheight,l))),wn.stop().animate({width:n,height:o},t,function(){_n.removeClass(ve)}),ii(),zi&&(xn.stop().animate({width:Nn.nw},t),Jt({guessIndex:Dn,time:t,keep:!0}),Ai&&$t.nav&&Rt(t)),Ji=i||!0,$i())),Wn=wn.offset().left,this},ln.setOptions=function(e){return n.extend(a,e),bi(),this},ln.shuffle=function(){return ki&&A(ki)&&bi(),this},ln.destroy=function(){return ln.cancelFullScreen(),ln.stopAutoplay(),ki=ln.data=null,u(),Ei=[],ti(Gt),bi.ok=!1,this},ln.playVideo=function(){var e=Mi,t=e.video,i=Dn;return"object"==typeof t&&e.videoReady&&(Ri&&ln.fullScreen&&ln.cancelFullScreen(),F(function(){return!bt.is()||i!==Dn},function(){i===Dn&&(e.$video=e.$video||n(n.Fotorama.jst.video(t)),e.$video.appendTo(e[Gt]),_n.addClass(fe),Ti=e.$video,g(),$n.blur(),En.blur(),ai("loadvideo"))})),this},ln.stopVideo=function(){return ui(Ti,!0,!0),this},wn.on("mousemove",pi),zn=ie(gn,{onStart:oi,onMove:function(e,t){ci(wn,t.edge)},onTouchEnd:si,onEnd:function(e){ci(wn);var t=(zt&&!sn||e.touch)&&a.arrows&&"always"!==a.arrows;if(e.moved||t&&e.pos!==e.newPos&&!e.control){var i=w(e.newPos,Nn.w,a.margin,ji);ln.show({index:i,time:Hi?Vi:e.time,overPos:e.overPos,user:!0})}else e.aborted||e.control||mi(e.startEvent,t)},timeLow:1,timeHigh:1,friction:2,select:"."+Qe+", ."+Qe+" *",$wrap:wn}),Bn=ie(Cn,{onStart:oi,onMove:function(e,t){ci(xn,t.edge)},onTouchEnd:si,onEnd:function(e){function t(){Jt.l=e.newPos,ri(),li(),yt(e.newPos,!0)}if(e.moved)e.pos!==e.newPos?(tn=!0,X(Cn,{time:e.time,pos:e.newPos,overPos:e.overPos,onEnd:t}),yt(e.newPos),Qi&&ci(xn,D(e.newPos,Bn.min,Bn.max))):t();else{var i=e.$target.closest("."+Ne,Cn)[0];i&&wi.call(i,e.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:xn}),An=ne(wn,{shift:!0,onEnd:function(e,t){oi(),si(),ln.show({index:t,slow:e.altKey})}}),Un=ne(xn,{onEnd:function(e,t){oi(),si();var i=b(Cn)+.25*t;Cn.css(d(s(i,Bn.min,Bn.max))),Qi&&ci(xn,D(i,Bn.min,Bn.max)),Un.prevent={"<":i>=Bn.max,">":i<=Bn.min},clearTimeout(Un.t),Un.t=setTimeout(function(){Jt.l=i,yt(i,!0)},Bt),yt(i)}}),_n.hover(function(){setTimeout(function(){on||fi(!(sn=!0))},0)},function(){sn&&fi(!(sn=!1))}),N($n,function(e){K(e),gi.call(this,e)},{onStart:function(){oi(),zn.control=!0},onTouchEnd:si}),$n.each(function(){G(this,function(e){gi.call(this,e)}),vi(this)}),G(jn,ln.toggleFullScreen),vi(jn),n.each("load push pop shift unshift reverse sort splice".split(" "),function(e,t){ln[t]=function(){return ki=ki||[],
"load"!==t?Array.prototype[t].apply(ki,arguments):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].length&&(ki=B(arguments[0])),bi(),ln}}),bi()},n.fn.fotorama=function(t){return this.each(function(){var i=this,a=n(this),o=a.data(),s=o.fotorama;s?s.setOptions(t,!0):F(function(){return!E(i)},function(){o.urtext=a.html(),new n.Fotorama(a,n.extend({},Zt,e.fotoramaDefaults,t,o))})})},n.Fotorama.instances=[],n.Fotorama.cache={},n.Fotorama.measures={},n=n||{},n.Fotorama=n.Fotorama||{},n.Fotorama.jst=n.Fotorama.jst||{},n.Fotorama.jst.style=function(e){var t,i="";return gt.escape,i+=".fotorama"+(null==(t=e.s)?"":t)+" .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:"+(null==(t=e.m)?"":t)+"px;\nheight:"+(null==(t=e.h)?"":t)+"px}\n.fotorama"+(null==(t=e.s)?"":t)+" .fotorama__thumb-border{\nheight:"+(null==(t=e.h-e.b*(e.q?0:2))?"":t)+"px;\nborder-width:"+(null==(t=e.b)?"":t)+"px;\nmargin-top:"+(null==(t=e.m)?"":t)+"px}"},n.Fotorama.jst.video=function(e){var t="",i=(gt.escape,Array.prototype.join);return t+='<div class="fotorama__video"><iframe src="',function(){t+=i.call(arguments,"")}(("youtube"==e.type?e.p+"youtube.com/embed/"+e.id+"?autoplay=1":"vimeo"==e.type?e.p+"player.vimeo.com/video/"+e.id+"?autoplay=1&badge=0":e.id)+(e.s&&"custom"!=e.type?"&"+e.s:"")),t+='" frameborder="0" allowfullscreen></iframe></div>\n'},n(function(){n("."+re+':not([data-auto="false"])').fotorama()})}(window,document,location,"undefined"!=typeof jQuery&&jQuery),function(){function e(){this.siteExpandSpeed=200,this.siteExpandMargins=20,this.tarifMaxSites=0,this.tarifMaxPages=0,this.tarifMaxDomains=0,this.countDomains=0,this.tarifCurSites=0,this.sitePrice=0,this.draggingSiteData={},this.hasTariffDaily=!1,this.in_preview=!1,this.max_file_fields=null,this.is_ready=!1}function t(){this.ajaxHandlers={},this.flagIsReady=!1,this.isReady=function(){return this.flagIsReady};var e=this;this.init=function(t){e.id=t.form_id,e.el=document.getElementById(e.id),e.$el=$(e.el),e.initial_screen_id=$(".initial-screen").attr("id"),e.current_screen_id=e.initial_screen_id,e.$tpl_field=e.$el.find("#"+e.id+"__tpl"),e.$tpl_preview_field=e.$el.find("#tpl-id-in-preview"),e.$empty_tpl_field=e.$el.find("#"+e.id+"__empty_tpl"),e.$phone_field=e.$el.find("#"+e.id+"__phone"),e.$phone_output_error=e.$el.find("#sp6_create_site_output_phone_error"),e.$name_field=e.$el.find("#"+e.id+"__name"),e.$phone_field.on("change",function(){e.$phone_output_error.empty(),e.validatePhone()}),e.$el.on("submit",function(t){if(!e._is_allow_submit)return t.preventDefault(),!1}),e.$el.find(".sp6-go-to-step").on("click",function(){var t,i=$(this),n=i.attr("data-actions").toString().split(",");for(t=0;t<n.length;t++)switch(n[t]){case"ajax":var a=i.attr("data-ajax-handler");e.runAjaxHandler(a);break;case"showScreen":var o=i.attr("data-carrot-event");if(o&&o.length>0&&analyticSendEvent(o),0==e.showScreen(i.attr("data-screen-id")))return!1;break;case"setCategoryFilter":if(0==e.setCategoryFilter(i))return!1;break;case"setTpl":var s=i.attr("data-site");if(0==e.setTpl(s))return!1;tracerSendEvent("site_tpl_chosen",{site_tpl_id:s});break;case"setEmptyTpl":e.$empty_tpl_field.val(0),tracerSendEvent("site_tpl_chosen",{site_tpl_id:0,empty:1}),funnelEvent(3,12);break;case"setNeedTpl":e.$empty_tpl_field.val(1),funnelEvent(2,6);break;case"showCalcScreen":switch(e.initial_screen_id){case"sp6_create_site_init":if(0==e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init":"sp6_create_site_choose_tpl"))return!1;break;case"sp6_create_site_init_new":if(e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init_new":"sp6_create_site_choose_tpl_new"))return!1}break;case"back":e.fixBack();break;case"closePreviewTpl":sitesMan.closePreviewTpl();break;case"setTplFromPreview":var s=e.$tpl_preview_field.val();if(0==e.setTpl(s))return!1;tracerSendEvent("site_tpl_chosen",{site_tpl_id:s}),sitesMan.closePreviewTpl();break;case"clearPhone":e.$phone_field.val("");break;case"submit":return e.submit(i),i=null,!1;case"loadTpls":e.loadVisibleTpls(i)}return i=null,!1}),this.flagIsReady=!0,FE.runAndClr("create_page_form/ready")},this.fixBack=function(){switch(!0){case"block"==$("#sp6_create_site_init").css("display"):sitesMan.goToSites();break;case"block"==$("#sp6_create_site_input_name").css("display"):e.showScreen("sp6_create_site_input_phone");break;case"block"==$("#sp6_create_site_input_phone").css("display"):window.newGetPhoneWindow?window.newGetPhoneWindow.btn.trigger("click"):e.submit($("#sp6_create_site_input_phone .btn-1.sp6-go-to-step"))}},this.setTpl=function(t){return!!t&&(e.$tpl_field.val(t),e.$empty_tpl_field.val(1),!0)},this.validateName=function(){return!0},this.validatePhone=function(){return!0},this.submit=function(t){return!(t.hasClass("disabled")||!e.validateName()||!e.validatePhone()||(t.addClass("disabled"),e.$tpl_preview_field.remove(),e._is_allow_submit=!0,e.el.submit(),1))},this.setCategoryFilter=function(t){var i=t.attr("data-class"),n=i.match(/[\d]*$/),a=sitesMan.$tplsList.children(".not-loaded."+i);e.$el.find(".btn-category.selected").removeClass("selected"),sitesMan.$tplsList.removeClass(),sitesMan.$tplsList.addClass("clearfix show_"+i),t.addClass("selected");for(var o=0;o<7&&a[o];o++)sitesMan.loadSiteTplImage(a[o]);return n.length&&n[0].length&&tracerSendEvent("site_tpl_category_chosen",{site_tpl_category_id:n[0]}),a=null,!0},this.showScreen=function(t){if(!t)return!1;var i=(userHasTag("LPM-706"),!1);switch(t){case"sp6_create_site_init":break;case"sp6_create_site_init_new":break;case"sp6_create_site_input_name":break;case"sp6_create_site_input_phone":userHasTag("LPM-842")&&window.phoneMask&&(i=!0)}return e.$el.find("#"+e.current_screen_id).fadeOut(100,function(){e.$el.find("#"+t).fadeIn(100,function(){switch(e.current_screen_id=t,t){case"sp6_create_site_input_name":e.$name_field.focus();break;case"sp6_create_site_input_phone":if(i){window.phoneMask.init();var n=window.phoneMask.getPhoneCountry();n?window.phoneMask.applyMask(n):window.phoneMask.applyMask("rus")}else e.$phone_field.focus();break;case"sp6_create_site_choose_tpl":sitesMan.initChooseTpl()}})}),!0},this.loadVisibleTpls=function(e){var t=$(".tpls-list-to-load"),i=e.attr("data-cat-id");t.attr("class",t.attr("class").replace(/show_cat_(all|[0-9]+)/g,"").replace(/\s+/g," ")),t.addClass("show_cat_"+i);var n=t.find(".site-preview-template.not-loaded.cat_"+i);n.length>0&&ImgListLoader.create(n,{onload_callback:function(){$(this).closest(".site-preview-template").removeClass("not-loaded")}}).run()},this.setAjaxHandler=function(e,t){this.ajaxHandlers[e]=t},this.runAjaxHandler=function(e){if(!this.ajaxHandlers[e])throw new Error("Не существующее имя обработчика [#3557]");this.ajaxHandlers[e]()}}e.prototype.ready=function(){consoleDbg("INIT: sites man"),this.$sitesList=$("#sites_list1"),this.$is_tpl_changed=$("#frmnotifymail__is_tpl_changed"),this.initSiteHeaderClick(),this.bindOpengraphEvents(),$("table.file_config").length&&this.initFilesTab(),this.is_ready=!0,FE.runAndClr("sitesMan/ready")},e.prototype.isReady=function(){return this.is_ready},e.prototype.initFilesTab=function(){$(".file_ops .edit_file").click(sitesMan.startEditFileName),$(".file_name_h_span").dblclick(sitesMan.startEditFileName),$(".file_name_rollback").click(function(){$(this).closest(".file_name").removeClass("edit-mode")}),$(".file_name_save").click(sitesMan.finishEditFileName),$(".file_name_inp").keydown(function(e){13==e.keyCode&&sitesMan.finishEditFileName.call(this)})},e.prototype.startEditFileName=function(){var e=$(this).hasClass("edit_file")?$(this).closest("tr").find(".file_name"):$(this).closest(".file_name");e.addClass("edit-mode"),e.find(".file_name_inp").focus()},e.prototype.finishEditFileName=function(){var e=$(this).closest(".file_name"),t=e.find(".file_name_edit .file_name_inp"),i=$(this).closest("tr.file_row").find(".file_upload_state div");ajaxLoad({url:t.attr("site_id")+"/sites/rename_site_file/id:"+t.attr("file_id"),data:{name:t.val()},success:function(e){void 0!==e.res&&0==e.res&&void 0===e.mes&&alert("Ошибка! "+mes)}}),e.find(".file_name_h_span").text(t.val()),e.removeClass("edit-mode"),i.removeClass("ok not-pub").addClass("sync"),e=t=null},e.prototype.initSiteHeaderClick=function(){this.$sitesList.children(".one_site").find(".site_expander a").click(function(){var e=$(this).closest(".one_site"),t=e.attr("id").replace("site-",""),i=$.cookie("sites_expanded");isset(i)||(i=""),e.hasClass("collapsed")?(-1==i.indexOf(t)&&(i+=","+t),e.removeClass("collapsed")):(-1!==i.indexOf(t)&&(i=i.replace(t,"")),e.addClass("collapsed")),i=i.replace(/[,]+/g,","),i=i.replace(/^[,]+/,""),setStateCookie("sites_expanded",i),i=e=t=null})},e.prototype.initSiteTabs=function(){this.$sitesList.children(".one_site").find(".one_site_tabs .td_one_site_tab").click(function(){$(this).parent().children(".td_one_site_tab.sel").removeClass("sel"),$(this).addClass("sel"),$(this).closest(".one_site_cont").find(".one_site_tabcont > .one_site_tab").hide().filter("#"+$(this).attr("tab")).show()}),this.$sitesList.find(".one_site").find(".one_site_tabs .td_one_site_tab:first").click()},e.prototype.initSiteLinks=function(){this.$sitesList.find(".site_links a").click(function(){return void 0===$(this).data("clicked")&&($(this).animate({paddingLeft:26},100,function(){$(this).addClass("loading")}),$(this).data("clicked",!0),!0)})},e.prototype.collapseAllSites=function(){$(".one_site").addClass("collapsed"),setStateCookie("sites_expanded","")},e.prototype.initStatChart=function(e,t,i){$("#"+e).highcharts({chart:{type:"column",renderTo:"container",showAxes:!0,style:{fontSize:"16"},spacingTop:0,spacingRight:0,spacingBottom:10,spacingLeft:0,height:"250",width:"668"},title:{text:"Посещаемость сайта"},credits:{enabled:!1},xAxis:{categories:t,gridLineWidth:1,gridLineColor:"#EDEDED",tickmarkPlacement:"on",min:0,max:30,labels:{step:2}},scrollbar:{enabled:!0},yAxis:{title:{text:"Посетители",style:{fontFamily:"Verdana",color:"#CCC",fontWeight:"normal"}},labels:{step:1},gridLineColor:"#EDEDED"},series:[{name:"Посетителей",data:i}],tooltip:{headerFormat:'<span style="font-size: 14px">{point.key}</span><br/>',pointFormat:'<span style="font-size: 14px">{series.name} <b>{point.y}</b></span>',useHTML:!0},plotOptions:{column:{animation:!1}},legend:{enabled:!1},colors:["#C3B0FA"]})},e.prototype.initDatePiker=function(e){"string"==typeof e&&(e=$(e)),e.datepicker({showAnim:"show",prevText:"Предыдущий месяц",nextText:"Следующий месяц",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dateFormat:"dd.mm.yy",firstDay:1,showButtonPanel:!0,currentText:"Сегодня",closeText:"Закрыть",constrainInput:!0,beforeShow:function(e,t){$(e).attr("disabled","disabled").blur()},onClose:function(e,t){$(this).removeAttr("disabled")}})},e.prototype.sendDeclarationForm=function(e){var t=$(e),i=t.closest("form"),n=i.attr("id"),a={},o={},s=0,r=0;a.sum=i.find('input[name="'+n+'[sum]"]'),a.d_start=i.find('input[name="'+n+'[date_start]"]'),a.d_end=i.find('input[name="'+n+'[date_end]"]'),a.check=i.find('input[name="'+n+'[avg_check]"]'),a.conv=i.find('input[name="'+n+'[conversion]"]');for(s in a)if("d_start"==s||"d_end"==s){if(!(r=a[s].val().match(/^(\d{2})\.(\d{2})\.(\d{4})$/)))return alert("Необходимо ввести правильную дату"),void a[s].focus();o[s]=parseInt(r[3]+r[2]+r[1])}else if(o[s]=a[s].val(),!a[s].val().match(/^\d+$/))return alert("Необходимо ввести правильное число"),void a[s].focus();return o.d_start>o.d_end?void alert("Дата начала должна быть раньше даты окончания"):void $.ajax({url:window.baseUrl+"sites/ajax/frm:frmdeclaration/id:"+n,type:"POST",cache:!1,dataType:"json",data:i.serialize(),timeout:4e4})},e.prototype.changeDeclaration=function(e){var t=$(e).closest(".declaration_view");t.hide(),t.prev(".declaration_edit_form").show()},e.prototype.cancelDeclarationEditting=function(e){var t=$(e).closest(".declaration_edit_form");t.hide(),t.next(".declaration_view").show()},e.prototype.createSiteChooseTpl=function(e){var t=$(e);t.closest("#tpls_list").children(".active").removeClass("active"),t.closest(".one_tpl").addClass("active"),t=null},e.prototype.createInit=function(){$("#frmonesite__empty_tpl input[type=radio]").click(function(){var e=$("#tpls_list"),t=$("#sites_create_blk"),i=$("#td_before_btn"),n=e.find(".one_tpl");t.is(":animated")||(1==parseInt($(this).val())?803>t.width()&&!e.is(":visible")&&(n.hide(),e.show(),t.animate({width:803},600,function(){$("#tpls_list .one_tpl").show()}),i.animate({width:0},600)):e.is(":visible")&&(n.hide(),e.hide(),t.animate({width:700},600),i.animate({width:60},600))),e=t=i=n=null}),helpSlider("#tplslide_helper")},e.prototype.createSiteCheckboxEmptyClick=function(){var e=$("#frmonesite__empty_tpl input[type=radio]:checked"),t=$("#sites_create_blk"),i=$("#td_before_btn");1==e.val()?(e.show(),t.animate({width:803},600),i.animate({width:0},600)):(e.hide(),t.animate({width:700},600),i.animate({width:60},600)),e=t=i=null},e.prototype.initNewList=function(){$("#sitesTutorialVideo").wind("setShowFunc",function(e){var t=e.$el.find(".wind-body"),i=e.$el.find(".pat");return t.html("<iframe "+i.html()+"></iframe>"),t=i=null,!0}).wind("setAfterCloseFunc",function(e){return e.$el.find(".wind-body").html(""),setcookie("sites_tutorial_closed",1,(new Date).getTime()+2592e3,"/"),!0}),$(".tbody_sites").length>0&&$(".tbody_sites").sortable({connectWith:".tbody_sites",handle:".site_lbl",placeholder:"sort_ph",opacity:1,cursor:"move",tolerance:"pointer",dropOnEmpty:!0,start:function(e,t){$(this).sortable("refreshPositions"),t.placeholder.addClass("tr_site fnt2").html('<td colspan="5"><div>ПОМЕСТИТЬ САЙТ ЗДЕСЬ</div></td>'),t.helper.css({width:"auto",height:"auto"}),sitesMan.draggingSiteData[t.item.attr("id-site")]={parent:t.item.parent(),prev:t.item.prev(),item:t.item},sitesMan._used_domains=sitesMan.getUsedDomains(),userHasTag("MTR-47")&&projectManager.startDragSite()},stop:function(e,t){if(userHasTag("MTR-47")&&projectManager.stopDragSite(),null!==sitesMan.sitesAjax)return jAlert("Подождите, когда завершится предыдущая команда перемещения."),void sitesMan.moveSiteBack(t.item.attr("id-site"));var i=t.item.closest(".iblk").attr("id");if(sitesMan.tarifMaxPages>0&&"iblk-monthly"==i&&sitesMan.getMonthlyPagesCount()>sitesMan.tarifMaxPages)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertTarifIsFull(sitesMan.tarifMaxPages);else if(sitesMan.tarifMaxDomains>0&&t.item.attr("data-root_domain")&&-1==$.inArray(t.item.attr("data-root_domain"),sitesMan._used_domains)&&"iblk-monthly"==i&&sitesMan.getActiveDomainsCount()>sitesMan.tarifMaxDomains)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertDomainsLimitIsFull(sitesMan.tarifMaxDomains);else if("iblk-daily"==i){var n=parseInt(t.item.attr("last-pay"));isNaN(n)||n<sitesMan.curCronDate?sitesMan.alertDailySiteNeedPayment(function(){sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos()},function(){sitesMan.moveSiteBack(t.item.attr("id-site"))}):(sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos())}else sitesMan.updateSiteSwitch(t.item,i),sitesMan.recountSitesPos();i=null},over:function(e,t){sitesMan.showHideEmptyBlocks(),sitesMan.recountDailyExpense()}}),"undefined"!=typeof access&&(access.onAddAccess=function(){var e=access.accessData.site_id,t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"))t.removeClass("hidden").prev().addClass("hidden"),t.children(".count-access").html("1");else{var i=parseInt(t.children(".count-access").html());t.children(".count-access").html(i+1)}},access.onRemoveAccess=function(e){var t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"));else{var i=parseInt(t.children(".count-access").text().trim());isNaN(i)||i-1<=0?(t.addClass("hidden").prev().removeClass("hidden"),t.children(".count-access").text(" ")):t.children(".count-access").text(i-1)}}),$(document).on("click",".info-new-access",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),i=t.children(".popup_info"),n=function(e){$(".popup_info").hide(),$(document).unbind("click",n)};"block"==i.css("display")?$(document).unbind("click",n):($(".popup_info").hide(),i.show(),$(document).bind("click",n))}),$(document).on("click",".add-new-access",function(){access.data.site_id=$(this).attr("site_id"),access.addEmailAccess()}),$(document).on("click",".access-site",function(){var e,t,i,n;access.data.site_id=$(this).attr("site_id"),$.get(window.baseUrl+"access/ajax/frm:getsiteaccess/id:"+access.data.site_id,function(a){e=$("#myModal"),t=e.find(".access-user-item.hidden");var o=$(".tr_site[id-site="+access.data.site_id+"] .site_name_h span");e.find(".access-site-name").text(o.text()),e.find(".access-user-item:not(.hidden, .add)").remove(),e.modal();for(var s=0;s<a.accesses.length;s++)i=t.clone().removeClass("hidden"),n=a.accesses[s].email,t.before(i),i.children(".access-user-item__email").html(n)})}),$(document).on("click",".access-user-item:not(.add)",function(){var e=$(this).children(".access-user-item__email").html();$("#myModal").modal("hide"),access.accessData={email:e,site_id:access.data.site_id},access.openModal()}),$(document).on("click",".tr_site .site_name .site_name_h div.edit_name, .abtest_item .abtest_name .site_name_h div.edit_name",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp");i.val($(this).closest(".site_name_h").children("span").text().trim()),t.addClass("edit-mode"),i.focus(),t=i=null}),$(document).on("click",".tr_site .site_name .site_name_save",function(e){var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp");ajaxLoad({url:i.attr("site_id")+"/sites/ajax/frm:frmsitename",data:{frmsitename:{name:i.val()},from_list:1}}),t.find(".site_name_h span").text(i.val().trim()),t.removeClass("edit-mode"),t=i=null}),$(document).on("click",".abtest_item .abtest_name .site_name_save",function(e){var t=$(this).closest(".site_name"),i=t.find(".site_name_edit .site_name_inp"),n=$(this).closest(".abtest_item").attr("variant-id");ajaxLoad({url:i.attr("site_id")+"/sites/ajax/frm:frmvariantname",data:{frmvariantname:{name:i.val().trim(),variant_id:n},from_list:1}}),t.find(".site_name_h span").text(i.val().trim()),t.removeClass("edit-mode"),t=i=null}),$(document).on("click",".vl-item",function(e){var t=0;$("input.vl-item").each(function(){$(this).prop("checked")&&t++}),t>1?$("#vl-btn-start").removeClass("disabled"):$("#vl-btn-start").addClass("disabled")}),$("#vl-btn-start").unbind("click").bind("click",function(){var e=[];$("input.vl-item").each(function(){$(this).prop("checked")&&e.push($(this).attr("id-site"))}),e.length>1&&(lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{list:e,do:"set_list"},success:function(e){1==e?location.reload():console.log(e)}}))}),$("#vl-btn-stop").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{do:"stop"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".disable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"disable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".enable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"enable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".delete-variant").unbind("click").bind("click",function(){$("#vl-btn-delete").attr("variant-id",$(this).closest(".abtest_item").attr("variant-id")),$("#delete_variant").modal("show")}),$("#vl-btn-delete").unbind("click").bind("click",function(){lockScreen();var e=$(this).attr("variant-id");return $.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:e,do:"delete_variant"},success:function(t){1==t?sitesMan.afterVariantDelete(e):console.log(t)}}),!1}),$(".set-base-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"set_base_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(document).on("click",".tr_site .site_name .site_name_rollback, .abtest_item .abtest_name .site_name_rollback",function(e){$(this).closest(".site_name").removeClass("edit-mode")}),this.curCronDate=null,this.dailyExpenseBlock=$("#daily_expense"),this.dailySitesList=$("#iblk-daily .tbody_sites:first"),this.monthlySitesList=$("#iblk-monthly .tbody_sites:first"),this.sitesAjax=null},e.prototype.createEmptyVariant=function(e){return window.location.href=window.baseUrl+siteId+"/sites/create_empty_variant/variant_for:"+e,!1},e.prototype.cloneVariant=function(e){return window.location.href=window.baseUrl+e+"/sites/clone_site/variant_for:"+siteId+"/redirect_to:tab_abtest",!1},e.prototype.initEditSiteName=function(){$(document).on("click",".bs_block_title h1.fnt .icon-pencil2",function(e){var t=$(this).parent(".fnt:first"),i=t.find(".site_name_edit .site_name_inp");t.css("height",t.outerHeight()),i.val(t.children("span").text()),t.addClass("edit-mode"),i.focus(),t=i=null}),$(document).on("click",".bs_block_title h1.fnt .site_name_save",function(e){var t=$(this).parents(".fnt:first"),i=t.find(".site_name_edit .site_name_inp");ajaxLoad({url:siteId+"/sites/ajax/frm:frmsitename",data:{frmsitename:{name:i.val()},from_list:1}}),t.css("height","auto").removeClass("edit-mode"),t.children("span:first").text(i.val()),t=i=null}),$(document).on("click",".bs_block_title h1.fnt .site_name_rollback",function(e){$(this).parents(".fnt:first").css("height","auto").removeClass("edit-mode")})},e.prototype.alertDailySiteNeedPayment=function(e,t){jAlert('<div class="title_for_message">Этот сайт еще не публиковался сегодня</div><div class="text_for_message">За него сразу будет списана оплата за 1 день</div>',{width:600,btnCls:"btn-success",btnWidth:160,okText:"Продолжить",onOk:e||function(){},onCancel:t||function(){}})},e.prototype.alertOnlySiteOwner=function(e){var t="Это действие может совершить только владелец сайта!";switch(e){case"on_site_publish":t="Опубликовать сайт может только владелец!";break;case"off_site_publish":t="Отключить сайт может только владелец!"}jAlert('<div class="title_for_message">'+t+"</div>",{width:600,btnCls:"btn-success",btnWidth:160,okText:"Хорошо",onOk:function(){},onCancel:function(){}})},e.prototype.alertDomainsLimitIsFull=function(e){jAlert('<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить <br/><strong>максимум '+e+" домен"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Запустите сайт на поддомене или<br/>прикрепите к другому сайту как страницу.</br/>Также вы можете перейти на более "мощный" тариф.</div>',{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/tarifs');",200),!1}})},e.prototype.alertTarifIsFull=function(e){jAlert('<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить<br/><strong>максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Выключите один из сайтов или</br>перейдите на более высокий тариф.</div>',{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",alertClass:"alert-max-sites-constraint",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/tarifs');",200),!1}})},e.prototype.alertTarifIsFullInTest=function(e){jAlert('<div class="img_for_message img_off"></div><p class="title_for_message">На текущем тарифе вы можете запустить<br/><strong> максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></p><hr/><div class="text_for_message"><a href="'+baseUrl+'sites/list">Выключите</a> один из сайтов </br> или </br>Перейдите на более "мощный" тариф  в разделе Баланс.</div>',{width:700,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти в Баланс",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200),!1}})},e.prototype.moveSiteBack=function(e,t){if(this.draggingSiteData[e]&&(this.draggingSiteData[e].prev.length?this.draggingSiteData[e].item.insertAfter(this.draggingSiteData[e].prev):this.draggingSiteData[e].item.prependTo(this.draggingSiteData[e].parent),this.draggingSiteData[e].item.attr("cur-grp",this.draggingSiteData[e].item.closest(".iblk").attr("id"))),this.showHideEmptyBlocks(),this.recountDailyExpense(),void 0!==t){for(var i in t)$(".tr_site[id-site="+i+"]").attr("pos",t[i]);i=null}},e.prototype.getMonthlySitesCount=function(){return this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getMonthlyPagesCount=function(){return this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getUsedDomains=function(){var e=[];return this.monthlySitesList.children("tr[data-root_domain]:not(.ui-sortable-helper):not(.sort_ph)").each(function(){var t=$(this).attr("data-root_domain");-1==$.inArray(t,e)&&e.push(t)}),e},e.prototype.getActiveDomainsCount=function(){return this.getUsedDomains().length},e.prototype.showHideEmptyBlocks=function(){$(".tbody_sites .tr_empty").each(function(){var e=$(this);if(userHasTag("MTR-47")&&"projects"==projectManager.getProjectsViewState()){var t=projectManager.currentProject.id,i=e.parent(),n=i.find(".tr_site[data-project-id="+t+"]:not(.ui-sortable-helper)"),a=i.find(".sort_ph:not(.hidden)");n.length||a.length?e.hide():e.show()}else e.parent().children("tr.tr_site:not(.ui-sortable-helper)").length>0?e.hide():e.show();e=null})},e.prototype.recountDailyExpense=function(){this.dailyExpenseBlock.length&&this.dailyExpenseBlock.text(this.dailySitesList.find(".tr_site:not(.ui-sortable-helper)").length*this.sitePrice)},e.prototype.recountSitesPos=function(){var e=null,t={},i=0,n=null,a=null,o=null;$("#sites_list").children(".iblk").each(function(){a=$(this).attr("id"),$(this).find(".tbody_sites .tr_site").each(function(s){++s,e=parseInt($(this).attr("pos")),o=$(this).attr("cur-grp"),(isNaN(e)||e!=s||a!=o)&&(n=parseInt($(this).attr("id-site")),isNaN(n)||(i++,t[n]={pos:s,oldPos:isNaN(e)?"":e,newParent:a},$(this).attr({pos:s,"cur-grp":a})))})});var s=window.location.href.match(/user:(\d+)/);i>0&&(this.sitesAjax=ajaxLoad({url:"sites/ajax/frm:frmsitespos"+(null!==s?"/user:"+s[1]:""),data:{list:t}})),e=t=i=n=a=o=null},e.prototype.showNotEnoughMoneyForDailySite=function(e){jConfirm("<p>На вашем балансе недостаточно средств.</p><p>Для запуска сайта за <strong>"+e.substr(4,2)+"."+e.substr(2,2)+".20"+e.substr(0,2)+"</strong> нужно, чтобы на балансе было минимум <strong>"+number_format(this.sitePrice,0)+" руб</strong>.</p><p>Пополните баланс и повторите операцию.</p>",{okText:"Пополнить",btnWidth:110,onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}})},e.prototype.errTplPublish=function(){jAlert("<p>Данный сайт является шаблоном, его нельзя опубликовать.</p><p>Вы можете нажать на шестеренку, выбрать пункт &laquo;Клонировать&raquo; и уже клонированный сайт сможете опубликовать.</p>")},e.prototype.onFaviconUpload=function(e,t){if(console.log(e.target.files[0]),!e.target.files[0].type.match(/^image\/(png|ico|x-icon|icon|vnd.microsoft.icon)/))return alert("Нужно выбрать картинку с расширением ICO или PNG."),!1;if(e.target.files[0].size>12e4)return void alert("Максимальный размер файла - 120 Кб.");0==$("#upload_target").length&&$("body").append('<iframe id="upload_target" name="upload_target" style="width:1px;height:1px;border:0;position:absolute;left:-9999px;visibility:hidden;"></iframe>');var i=$(t).closest("form");i.submit(),i=null},e.prototype.faviconUploadOk=function(e){$("img#favicon_img").attr("src",e.url),$(".favicon_edit").removeClass("empty")},e.prototype.goToSites=function(){location.href=window.baseUrl+"sites/list"},e.prototype.onSiteDelete=function(e,t,i){jConfirm("Удалить этот "+("variant"==i?"вариант":"сайт")+"?",{site:e,width:330,okClass:"ibtn-red",okText:"Да, удалить",btnWidth:114,onOk:function(){ajaxLoad({url:"sites/ajax/frm:delete_site/id:"+e,onSuccess:t})}})},e.prototype.afterSiteDelete=function(e){showDoneBox("Сайт удален",{width:200,cls:"c_text",showTime:1e3});var t=$("#sites_list .tr_site[id-site="+e+"]"),i=t.siblings(".tr_site"),n=t.siblings(".tr_empty");t.animate({opacity:0},1e3,function(){$(this).remove(),i.length<1&&n.show()}),t=null},e.prototype.afterVariantDelete=function(e){location.reload()},e.prototype.siteTransfer=function(e,t,i){$("#transver_site_name h5").text(i),$("#transver_site_name a").attr("href","http://"+t).text(t),$("#frmtransfer__site").val(e),$("#wndTransfer .ui_error").hide(),$(".wind#wndTransfer").wind("show"),$("#frmtransfer__mail").val("").focus()},e.prototype.confirmSiteTransfer=function(){jConfirm("Переносим сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, переносим",onOk:function(){ajaxLoad({url:"sites/ajax/frm:frmtransfer/ok:1"+(location.href.indexOf("/sites/view")>=0?"/goto:sites":""),data:$("#frmtransfer").serializeArray()})}})},e.prototype.siteTransferDone=function(e,t,i,n){$("#sites_list .tr_site[id-site="+e+"]").remove(),alert('Сайт "'+t+'" успешно перенесен пользователю '+i+"!"),$(".wind#wndTransfer").wind("hide"),"function"==typeof n&&n()},e.prototype.updateSiteSwitch=function(e,t){e.find(".site_publish .switch")["iblk-disabled"==t?"removeClass":"addClass"]("on")["iblk-disabled"==t?"addClass":"removeClass"]("off"),e.stop().css("background-color","#FFF7C2").animate({backgroundColor:"#fff"},5e3)},e.prototype.setPublished=function(e,t){var i=$(t),n=window.location.href.match(/user:(\d+)/);i.hasClass("on")?jConfirm("Вы уверены, что хотите выключить сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, выключить",onOk:function(){ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==n?"/user:"+n[1]:""),data:{id:e,action:"off"},onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_off":var t=$(".tr_site[id-site="+e.id+"]");t.appendTo($("#iblk-disabled .tbody_sites")),console.log(t.closest(".iblk")),sitesMan.updateSiteSwitch(t,t.closest(".iblk").attr("id")),t.attr("pos",e.pos),sitesMan.showHideEmptyBlocks(),showDoneBox("Сайт выключен",{width:200,cls:"c_text",showTime:1e3}),sitesMan.recountDailyExpense(),t=null}}})}}):(mxt("btn run site",{"источник":mxGetSourceLink(),"id сайта":e}),sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOn(e)},onCancel:function(){sitesMan.setPublishedOn(e,"daily")},onClose:function(){return!0}}):this.setPublishedOn(e)),n=i=null},e.prototype.setPublishedInTest=function(e){window.location.href.match(/user:(\d+)/),mxt("btn run site",{"источник":mxGetSourceLink(),"id сайта":e}),sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOnInTest(e)},onCancel:function(){sitesMan.setPublishedOnInTest(e,"daily")},onClose:function(){return!0}}):this.setPublishedOnInTest(e)},e.prototype.setPublishedOn=function(e,t,i){var n=window.location.href.match(/user:(\d+)/);ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==n?"/user:"+n[1]:""),data:{id:e,action:"on",type:t||"monthly",force:i||0},withCredentials:!0,onSuccess:function(i){if(1==i.res)switch(i.mes){
case"ok_site_on":var n=$(".tr_site[id-site="+i.id+"]");n.length?(n.appendTo($("#iblk-"+i.type+" .tbody_sites")),"daily"==i.type&&sitesMan.recountDailyExpense(),sitesMan.updateSiteSwitch(n,n.closest(".iblk").attr("id")),n.attr("pos",i.pos),sitesMan.showHideEmptyBlocks()):$("#btn-run-site").fadeOut(500),showDoneBox("Сайт запущен"+(void 0!==i.is_paid&&1==i.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3}),sitesMan.in_preview&&(window.location.href=window.location.href),n=null;break;case"tarif_is_full":sitesMan.alertTarifIsFull(i.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(i.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(i.action);break;case"need_tarif_activate":jAlert('<div class="img_for_message img_off mb2"></div><p>Для запуска сайта вам нужно перейти в раздел &laquo;Баланс&raquo; и подключить тариф.</p>',{width:400,btnWidth:200,okClass:"btn-success btn-alert-need-tarif",okText:"Перейти в Баланс",btnCls:"btn-success btn-alert-need-tarif",headerText:"Запуск сайта",alertClass:"alert-need-tarif",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/tarifs');",200)}});break;case"daily_tarif_is_off":jConfirm('<p>Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO.</p><p>Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить".</p>',{width:450,btnWidth:120,okClass:"ibtn-green",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":sitesMan.alertDailySiteNeedPayment(function(){sitesMan.setPublishedOn(e,t,1)});break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(i.curCronDate)}}}),n=null},e.prototype.setPublishedOnInTest=function(e,t,i){var n=window.location.href.match(/user:(\d+)/);ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==n?"/user:"+n[1]:""),data:{id:e,action:"on",type:t||"monthly",force:i||0},withCredentials:!0,onSuccess:function(i){if(1==i.res){switch(i.mes){case"ok_site_on":$("#btn-start-test").attr("href","#Start_test"),showDoneBox("Сайт запущен"+(void 0!==i.is_paid&&1==i.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3});break;case"tarif_is_full":sitesMan.alertTarifIsFullInTest(i.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(i.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(i.action);break;case"need_tarif_activate":jAlert('<div class="img_for_message img_off mb2"></div><div class="title_for_message">Для запуска сайта вам нужно перейти в раздел &laquo;Баланс&raquo; и подключить тариф</div>',{width:600,btnWidth:200,btnCls:"btn-success btn-alert-need-tarif",okText:"Перейти в Баланс",headerText:"Запуск сайта",alertClass:"alert-need-tarif",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/tarifs');",200)}});break;case"daily_tarif_is_off":jAlert('<div class="img_for_message img_pro"></div><div class="title_for_message">Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO</div><div class="text_for_message">Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить"</div>',{width:600,btnWidth:160,btnCls:"btn-success",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":sitesMan.alertDailySiteNeedPayment(function(){sitesMan.setPublishedOn(e,t,1)});break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(i.curCronDate)}$("#Start_test3").find("button.close:first").click()}}}),n=null},e.prototype.loadSiteTplImage=function(e){var t=$(e),i=t.find(".tpl-img");i.attr("src",i.attr("data-src")),i.removeAttr("data-src"),t.removeClass("not-loaded"),i=t=null},e.prototype.onSuccessSubmitFrmNeedSiteTpl=function(){$("#frmneedsitetpl__iwant").val("").closest(".modal").modal("hide"),alert("Вы отправили заявку!")},e.prototype.initChooseTpl=function(){if(userHasTag("LPM-841")){var e=function(){var e=$("#tpls-list"),t=e.find(".tpl-wrap > .tpl"),i=Math.round(1.075*t.width());e.find(".tpl-wrap > .tpl").each(function(){$(this).height(i),$(this).find(".tpl-hover").css({bottom:30-i})})};e(),$(window).bind("resize",e)}},e.prototype.initCreatePage=function(e){this.initChooseTpl(),userHasTag("LPM-842")&&(setTimeout(function(){$("#onboard-m1").addClass("appear")},100),setTimeout(function(){$("#onboard-m2").addClass("appear")},2e3),setTimeout(function(){$("#onboard-m2-btn").addClass("appear")},2e3)),this.$tplsList=$("#tpls-list"),e=e||{},this.create_page_form=new t,this.create_page_form.init(e),$(document).on("mousedown",".btn-tpl-choose",function(){sitesMan.create_page_form.$tpl_field.val($(this).attr("data-site"))}).on("click","img.tpl-img, .btn-tpl-preview",this.previewTpl);var i,n=userHasTag("LPM-841")?this.$tplsList.find(".tpl.not-loaded"):this.$tplsList.children(".tpl.not-loaded");for(i=0;i<7&&n[i];i++)this.loadSiteTplImage(n[i]);n=null,$(window).on("scroll.tpl-load",function(){if("block"==$("#sp6_create_site_choose_tpl").css("display")){var e=userHasTag("LPM-841")?sitesMan.$tplsList.find(".tpl.not-loaded"):sitesMan.$tplsList.children(".tpl.not-loaded");if(e.length){var t=$(window),i=t.scrollTop(),n=t.height();for(var a in e){if(!(e[a].offsetTop-(i+n)<20))break;sitesMan.loadSiteTplImage(e[a])}t=i=n=a=null}else $(window).off("scroll.tpl-load")}}),$(window).scroll()},e.prototype.setPageState=function(e,t){if($(".site_choose_btn[data-screen-id="+e+"]:first").click(),t){var i=$(".tpl-category__btn[data-class=cat_"+t+"]:first");i.length>0&&i.click()}},e.prototype.previewTpl=function(){var e=$(this).closest(".tpl"),t=parseInt(e.attr("id").replace("tpl-",""));$("body").addClass("no_overflow");var i=$("#tpl-preview-wrap"),n=i.find("#tpl-preview-iframe-wrap");i.addClass("visible"),n.children("iframe:visible").hide();var a=n.children("iframe[data-site="+t+"]");a.length?a.show():($("#tpl-loader").show(),$('<iframe src="'+window.baseUrl+t+'/pages/preview_tpl" data-site="'+t+'" onload="$(\'#tpl-loader\').hide()"></iframe>').appendTo(n)),$("#frm3__name").val($("#frm2__name").val()),$("#tpl-id-in-preview").val(t),$(this).hasClass("btn-tpl-preview")&&$(this).addClass("disabled"),tracerSendEvent("site_tpl_preview",{site_tpl_id:t})},e.prototype.closePreviewTpl=function(){$("body").removeClass("no_overflow"),$("#tpl-preview-wrap").removeClass("visible")},e.prototype.chooseTpl=function(){var e=$(this).closest(".tpl");parseInt(e.attr("id").replace("tpl-",""))},e.prototype.afterGenTelegramCode=function(e){$("#telegram_code_span").text(e),$("#telegram_code").show(),$("#telegram_ready").hide()},e.prototype.afterTelegramTurnOff=function(e){},e.prototype.afterGenVkCode=function(e){$("#vk_code_span").text(e),$("#vk_code").show(),$("#vk_ready").hide()},e.prototype.afterVkTurnOff=function(e){},e.prototype.uploadOpengraphImg=function(e,t){if(e.target.files[0]){if(!e.target.files[0].type.match(/^image\//))return alert("Нужно выбрать файл изображения."),!1;if(e.target.files[0].size&&e.target.files[0].size>1048576)return alert("Файл слишком большой. Максимальный размер = 1 Мегабайт."),!1}lockScreen("Загружаем картинку",{show_animation:!0,delay_before:1e3}),t.submit()},e.prototype.opengraphUploadOk=function(e){if(isset(e.ops)){var t=$(".og_preview_image");return t.length?void t.find("#og_image").attr({src:e.url,"data-orig-w":e.extra.w,"data-orig-h":e.extra.h}):(t=null,void consoleDbg("Картинка загружена, но не найден ее блок"))}},e.prototype.saveOpengraphData=function(){var e=$("#og_header").val(),t=$("#og_description").val();$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:saveopengraph",method:"POST",dataType:"json",data:{title:e,description:t},success:function(e){return e.res&&1==e.res?void $("#save_opengraph").text("Сохранено"):void alert(e.error)}})},e.prototype.initSocialLocker=function(){if($(".to-lock").sociallocker){var e=$(".to-lock").sociallocker({demo:!0,text:{header:'Нажмите "поделиться", чтобы активировать<br/>реферальные хвосты.',message:""},theme:"flat",buttons:{order:["vk-share"],counter:!0},vk:{appId:"5203064",like:{pageUrl:"http://lpmotor.ru",requireSharing:!0,title:"Нравится"},share:{pageUrl:"http://lpmotor.ru",pageTitle:"LPmotor – Конструктор сайтов и лендингов",pageDescription:"Сейчас создаю себе сайт на конструкторе http://LPmotor.ru! Кто хочет посмотреть на результат? ))",pageImage:"http://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png",title:"Поделиться"},subscribe:{group_id:"lpmotor",title:"Подписаться"}}});lockerHeight=e.outerHeight(),e.on("unlock.sociallocker.onp",function(e,t,i){console.log("unlocked"),$.ajax({url:window.baseUrl+"sites/ajax",method:"POST",dataType:"JSON",data:{block:"activate_ref_tails"},success:function(e){if(void 0!==e.res&&1==e.res){var t=$(".success_mes");$(".activate_reftails").hide(),t.html("Спасибо за ваш репост! <br><br>Реф-хвосты будут подключены в течение часа <br>По факту подключения вам придет письмо на <b>"+e.email+"</b>"),t.fadeIn()}else alert("Ошибка #2258\nНапишите пожалуйста нам в тех-поддержку support@lpmotor.ru")}})})}},e.prototype.tryPublishSite=function(e){$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:tryPublishSite",{id:window.siteId,action:"on",type:"monthly",force:0},function(t){if(t.res&&1==t.res)switch(t.mes){case"ok_site_on":$("#success_publish").modal("show"),e.onOk();break;default:jAlert("<br>Ошибка при публикации сайта [#2821]")}else if(t.mes)switch(t.mes){case"no_tarif":case"need_tarif_activate":$("#no_tarif_modal").modal("show");break;case"tarif_is_full":sitesMan.alertTarifIsFull2(t.max_sites);break;default:jAlert("<br>Необработанный ответ от сервера[#2831]")}else t.err&&jAlert("<br>"+t.err)},"JSON")},e.prototype.setIndexing=function(e){var t=e.find("#site_indexing"),i=(e.hasClass("on"),e.hasClass("on"),t.val()),n=$("#ref_follow_switch"),a=$("#ref_follow_section");$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:siteindexing",{site_indexing:i},function(t){return void 0!==t.res&&"index_on"==t.res?(n.removeClass("off").addClass("on"),void a.slideDown()):(void 0!==t.res&&"index_off"==t.res?(n.removeClass("on").addClass("off"),a.slideUp()):t.fail||t.error?1==t.fail?($("#not_published_modal").modal("show"),e.removeClass("on").addClass("off")):2==t.fail?($("#no_tarif_modal").modal("show"),e.removeClass("on").addClass("off")):alert(t.error):alert("ошибка при отключении/подключении индексирования сайта #2266"),!1)},"json")},e.prototype.watchType404=function(){"use strict";var e=$("#frmerrortype");e.on("change",function(){$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:siteErrorType",method:"post",dataType:"json",data:e.serialize(),success:function(e){0==e.res?alert(e.error):showDoneBox("Включен "+e.message,{width:300,cls:"c_text"})}})})},e.prototype.setRefFollow=function(e){var t=e.find("#ref_follow").val(),i=e.hasClass("on")?"on":"off",n=e.hasClass("on")?"off":"on";$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:ref_follow",{ref_follow:t},function(t){if(!t.res||1!=t.res)return t.error?alert(t.error):alert("ошибка при отключении/подключении передачи веса ссылок #2270"),e.removeClass(i).addClass(n),!1},"json")},e.prototype.publishSiteFromIndexing=function(e){ajaxLoad({url:"sites/ajax/frm:frmpublish2",data:{id:e,action:"on",type:"monthly",force:0},withCredentials:!0,onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_on":window.location.href=window.location.href;break;case"tarif_is_full":sitesMan.alertTarifIsFull2(e.max_sites)}}})},e.prototype.generateHTMLforPreview=function(e){var t="",i=e,n=$(".tip.small_img");n.hide();var a=$("#og_image"),o=intval(a.attr("data-orig-w")),s=intval(a.attr("data-orig-h"));o<=500&&"vk"==i&&(i="vk_mini"),("fb"==i&&o<=400&&o>=200||s/o>3||o/s>3)&&(i="fb_mini");var r=$(".preview_window");switch(r.hide(),i){case"vk":t+='<div class="preview_window_vk clearfix" >',t=this.generatePreviewHTML(t);break;case"vk_mini":t+='<div class="preview_window_vk_mini clearfix" >',t=this.generatePreviewHTML(t);break;case"fb":t+='<div class="preview_window_fb" >',t=this.generateFbPreviewHTML(t);break;case"fb_mini":t+='<div class="preview_window_fb_mini" >',t=this.generatePreviewHTML(t)}var l=a.attr("src");void 0===l||"fb"==i&&o<200&&s<200?(n.show(),t=strtr(t,{":SRC":"http://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png"})):t=strtr(t,{":SRC":l}),r.html(t),"fb"==i&&o/s>=2.1?(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="center center",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="auto 100%"):(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="0 50%",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="100%"),r.fadeIn()},e.prototype.generateFbPreviewHTML=function(e){return e+='<div class="img_wrapper" style="background: url(:SRC)" ></div>',e+='<div class="title_wrapper" >'+$("#og_header").val()+"</div>",e+='<div class="descr_wrapper" >'+$("#og_description").val()+"</div>",e+="</div>"},e.prototype.generatePreviewHTML=function(e){return e+='<div class="img_wrapper" ><img src=":SRC"></div>',e+='<div class="title_wrapper" >'+$("#og_header").val()+"</div>",e+='<div class="descr_wrapper" >'+$("#og_description").val()+"</div>",e+="</div>"},e.prototype.bindOpengraphEvents=function(){var e="",t=this,i=$("#og_header, #og_description");i.bind("keyup keydown blur",function(i){if(13==i.keyCode&&!i.shiftKey)return i.preventDefault(),!1;var n=$(this).val(),a=$(this).attr("id");"og_header"==a&&(e=t.countMessageLength(n,70)),"og_description"==a&&(e=t.countMessageLength(n,300)),$("#"+a+"_left").text(e)}),i.trigger("blur")},e.prototype.countMessageLength=function(e,t){return t-e.length},e.prototype.alertTarifIsFull2=function(e){jAlert("<p>На текущем тарифе вы можете запустить максимум<br/><strong>"+e+" сайт"+plural(e,"","а","ов")+'</strong>.</p><hr/><p class="fw_bold pt1" style="color: #f58f36;">Что теперь делать?</p><table class="mb2"><tr><td style="width:42%">Выключите один из сайтов, нажав на переключатель <span id="switch_example"></span> в <a href="'+window.baseUrl+'">главном меню </a>.</td><td class="vam c_text fw_bold" style="width:16%;">ИЛИ</td><td style="width:42%">Перейдите на более "мощный" тариф в разделе <a href="'+window.baseUrl+'profile/balance">Баланс </a>.</td></tr></table>',{width:550,btnWidth:200,okClass:"ibtn-green",okText:"Не сейчас",headerText:"Количество запущенных сайтов превышено"})},e.prototype.updateVariantLabels=function(e,t){$("label[for=ab_st_item_"+e+"]").find(".abtest_name_var:first").text(t),$("#variant-list-1[name=variant-list-1]").children("option[value="+e+"]").text(t)},e.prototype.cloneSite=function(e,t,i){var n={};n.type="ajax",void 0!==t&&(n.check_module=t),void 0!==i&&i&&(n.check_int=1),ajaxLoad({url:e+"/sites/clone_site",data:n,withCredentials:!0,onSuccess:function(t){if(1==t.res)if(void 0!==t.check_data){var i=$("#abtest__modal_copy"),n=i.find(".wrap_abtest_clone:first"),a=i.find(".wrap_integrations_clone:first"),o=i.find("#clone_integrations:first");o.prop("checked",!1),n.hide(),a.hide(),i.attr("site-id",e).wind("show"),void 0!==t.check_data.has_abtest&&n.show(),void 0!==t.check_data.has_int&&a.show()}else switch(t.mes){case"go_to":window.location.href=t.redirect_to}}})},e.prototype.doCloneSite=function(){var e=$("#abtest__modal_copy"),t=e.find("#clone_integrations:first"),i=t.prop("checked"),n=window.baseUrl+e.attr("site-id")+"/sites/clone_site";return i&&(n+="/copy_int:true"),window.location.href=n,!1},e.prototype.loadTextareas=function(){$(".textarea_load.need_load").each(function(e,t){var i=$(t),n=i.attr("data-id");if(n){var a=$("#textarea_data__"+n);if(a.length){var o=i.find("textarea:first");o.length&&(o.val(LpmBase64.decode(a.text())),$("#frmseo__"+n+"_allow").val("1"),i.removeClass("need_load")),o=null}a=null}i=n=null})},FE.runOnReady(function(){window.sitesMan=new e,window.sitesMan.ready(),FE.add("file_uploaded_favicon",function(e){sitesMan.faviconUploadOk(e)}),FE.add("file_uploaded_opengraph_image",function(e){sitesMan.opengraphUploadOk(e)})})}(),function(){"use strict";function e(e,t,i){this.complete=!1,this.ptr=e,this.killTimer=null,!t.shift&&t.selector&&(t=t.toArray()),this.list=t,this.ops=i||{},void 0===this.ops.max_loading&&(this.ops.max_loading=3),void 0===this.ops.onload_callback&&(this.ops.onload_callback=!1),n&&console.log("[ LOADER ] init",this)}var t=0,i={},n=!1;e.prototype.loadCycle=function(){if(0!=this.list.length){var e=this.list.shift(),t=$(e).find("img[data-src]");1==t.length?(t.load(function(){var e=ImgListLoader.get($(this).attr("loader-ptr")),t=ImgListLoader.isDebug();return e?(t&&console.log("[ LOADER ] image loaded",this),e.ops.onload_callback&&e.ops.onload_callback.apply(this),e.list.length>0?setTimeout("var L=ImgListLoader.get("+e.ptr+"); if (null!==L){L.loadCycle();}",1):e.complete||(e.complete=!0,t&&console.log("Loader #"+e.ptr+" completed")),void(e=null)):void console.log("[ LOADER ] not found #"+$(this).attr("loader-ptr"))}),t.attr("src",t.attr("data-src")),t.attr("loader-ptr",this.ptr),t.removeAttr("data-src")):ImgListLoader.isDebug()&&console.log("[ LOADER ] not 1 image found. ",t)}},e.prototype.run=function(){for(var e=0,t=Math.min(this.list.length,this.ops.max_loading);e<t;e++)this.loadCycle();this.killTimer=setInterval("var loader = ImgListLoader.get("+this.ptr+"); if (null!==loader && loader.complete){ ImgListLoader.kill("+this.ptr+") }",5e3)},e.prototype.removeTimer=function(){clearInterval(this.killTimer),this.killTimer=null},window.ImgListLoader={create:function(n,a){return i[++t]=new e(t,n,a),i[t]},get:function(e){return void 0!==i[e]?i[e]:null},getAll:function(){return i},setDebug:function(e){n=e},isDebug:function(){return n},kill:function(e){void 0!==i[e]&&(n&&console.log("[ LOADER ] kill #"+e),i[e].removeTimer(),delete i[e])}}}(),window.animManager=new FanimManager,window.animManager.ready();